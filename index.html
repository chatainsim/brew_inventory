<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brewing Inventory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Work+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg-dark: #0a0a0a;
            --bg-card: #1a1a1a;
            --accent-amber: #ff9500;
            --accent-gold: #ffc940;
            --text-primary: #ffffff;
            --text-muted: #a0a0a0;
            --border-subtle: #2a2a2a;
            --malt-color: #d97706;
            --houblon-color: #10b981;
            --levure-color: #ec4899;
            --autre-color: #8b5cf6;
        }
        
        body {
            font-family: 'Work Sans', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1200 100%);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255, 149, 0, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 201, 64, 0.02) 0%, transparent 50%);
            animation: drift 60s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes drift {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(1deg); }
            66% { transform: translate(-20px, 20px) rotate(-1deg); }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .animate-fade-up {
            animation: fadeInUp 0.8s ease-out forwards;
        }
        
        .animate-slide-in {
            animation: slideIn 0.6s ease-out forwards;
        }
        
        .stagger-1 { animation-delay: 0.1s; opacity: 0; }
        .stagger-2 { animation-delay: 0.2s; opacity: 0; }
        .stagger-3 { animation-delay: 0.3s; opacity: 0; }
        .stagger-4 { animation-delay: 0.4s; opacity: 0; }
        
        h1, h2 {
            font-family: 'Playfair Display', serif;
            font-weight: 900;
            letter-spacing: -0.02em;
        }
        
        .glass-card {
            background: rgba(26, 26, 26, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .glass-card:hover {
            border-color: rgba(255, 149, 0, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }
        
        .category-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: all 0.2s ease;
        }
        
        .category-badge::before {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }
        
        .malt {
            background: rgba(217, 119, 6, 0.15);
            color: var(--malt-color);
            border: 1px solid rgba(217, 119, 6, 0.3);
        }
        
        .malt::before { background: var(--malt-color); }
        
        .houblon {
            background: rgba(16, 185, 129, 0.15);
            color: var(--houblon-color);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .houblon::before { background: var(--houblon-color); }
        
        .levure {
            background: rgba(236, 72, 153, 0.15);
            color: var(--levure-color);
            border: 1px solid rgba(236, 72, 153, 0.3);
        }
        
        .levure::before { background: var(--levure-color); }
        
        .autre {
            background: rgba(139, 92, 246, 0.15);
            color: var(--autre-color);
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        .autre::before { background: var(--autre-color); }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-amber) 0%, var(--accent-gold) 100%);
            color: #000;
            font-weight: 600;
            padding: 12px 28px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.05em;
            box-shadow: 0 4px 15px rgba(255, 149, 0, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(255, 149, 0, 0.5);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            font-weight: 500;
            padding: 12px 28px;
            border-radius: 10px;
            border: 1px solid var(--border-subtle);
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.05em;
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 149, 0, 0.5);
            transform: translateY(-2px);
        }
        
        input, select {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border-subtle);
            color: var(--text-primary);
            padding: 12px 16px;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-family: 'Work Sans', sans-serif;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--accent-amber);
            background: rgba(255, 255, 255, 0.05);
            box-shadow: 0 0 0 3px rgba(255, 149, 0, 0.1);
        }
        
        input::placeholder {
            color: rgba(160, 160, 160, 0.5);
        }
        
        .filter-btn {
            padding: 10px 20px;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border-subtle);
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .filter-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            color: var(--text-primary);
        }
        
        .filter-btn.active {
            background: linear-gradient(135deg, var(--accent-amber) 0%, var(--accent-gold) 100%);
            color: #000;
            border-color: transparent;
            font-weight: 600;
        }
        
        .tab-container {
            display: flex;
            gap: 0;
            background: rgba(26, 26, 26, 0.4);
            padding: 6px;
            border-radius: 12px;
            overflow-x: auto;
            border: 1px solid var(--border-subtle);
        }
        
        .tab-button {
            flex: 1;
            min-width: 120px;
            padding: 14px 24px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            font-size: 0.95rem;
            border-radius: 8px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .tab-button::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-amber), var(--accent-gold));
            border-radius: 3px 3px 0 0;
            transition: width 0.3s ease;
        }
        
        .tab-button:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .tab-button.active {
            color: var(--text-primary);
            background: rgba(255, 149, 0, 0.15);
            font-weight: 600;
        }
        
        .tab-button.active::before {
            width: 80%;
        }
        
        .tab-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
            height: 24px;
            padding: 0 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .tab-button.active .tab-badge {
            background: rgba(0, 0, 0, 0.3);
            color: var(--accent-gold);
        }
        
        .tab-content {
            display: none;
            animation: fadeInUp 0.4s ease-out;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .collapsible-section {
            margin-bottom: 2rem;
        }
        
        .collapsible-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            cursor: pointer;
            background: rgba(26, 26, 26, 0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .collapsible-header:hover {
            background: rgba(26, 26, 26, 0.6);
            border-color: rgba(255, 149, 0, 0.3);
        }
        
        .collapsible-header.active {
            border-radius: 12px 12px 0 0;
            border-bottom-color: transparent;
            background: rgba(26, 26, 26, 0.6);
        }
        
        .collapsible-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .collapsible-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s ease;
            color: var(--accent-amber);
        }
        
        .collapsible-header.active .collapsible-icon {
            transform: rotate(180deg);
        }
        
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background: rgba(26, 26, 26, 0.4);
            border: 1px solid var(--border-subtle);
            border-top: none;
            border-radius: 0 0 12px 12px;
        }
        
        .collapsible-content.active {
            max-height: 1000px;
            transition: max-height 0.5s ease-in;
        }
        
        .collapsible-inner {
            padding: 1.5rem;
        }
        
        /* Compact inventory table */
        .inventory-table {
            width: 100%;
            border-collapse: collapse;
        }

        .inventory-table thead tr {
            border-bottom: 1px solid var(--border-subtle);
        }

        .inventory-table thead th {
            padding: 10px 12px;
            text-align: left;
            font-size: 0.72rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
        }

        .inventory-table thead th.th-right {
            text-align: right;
        }

        .inventory-item {
            border-bottom: 1px solid rgba(42, 42, 42, 0.6);
            transition: background 0.2s ease;
        }

        .inventory-item:last-child {
            border-bottom: none;
        }

        .inventory-item:hover {
            background: rgba(255, 149, 0, 0.04);
        }

        .inventory-item td {
            padding: 9px 12px;
            vertical-align: middle;
        }

        .item-name {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text-primary);
            white-space: nowrap;
            max-width: 220px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .item-origin {
            font-size: 0.8rem;
            color: var(--text-muted);
            white-space: nowrap;
            max-width: 160px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .item-notes {
            font-size: 0.78rem;
            color: rgba(160,160,160,0.6);
            font-style: italic;
            max-width: 180px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .item-qty-cell {
            text-align: right;
            white-space: nowrap;
        }

        .quantity-input {
            width: 72px;
            text-align: right;
            font-weight: 700;
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid transparent;
            border-radius: 6px;
            padding: 4px 8px;
            color: var(--text-primary);
            font-family: 'Work Sans', sans-serif;
            transition: border-color 0.2s;
        }

        .quantity-input:focus {
            outline: none;
            border-color: var(--accent-amber);
        }

        .item-unit {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-left: 4px;
        }

        .item-date {
            font-size: 0.75rem;
            color: rgba(160,160,160,0.5);
            white-space: nowrap;
        }

        .item-actions {
            display: flex;
            gap: 6px;
            justify-content: flex-end;
        }

        .edit-btn {
            width: 30px;
            height: 30px;
            border-radius: 7px;
            background: rgba(255, 149, 0, 0.08);
            border: 1px solid rgba(255, 149, 0, 0.2);
            color: var(--accent-amber);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
        }

        .edit-btn:hover {
            background: rgba(255, 149, 0, 0.2);
            transform: scale(1.1);
        }

        .delete-btn {
            width: 30px;
            height: 30px;
            border-radius: 7px;
            background: rgba(239, 68, 68, 0.08);
            border: 1px solid rgba(239, 68, 68, 0.2);
            color: #ef4444;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
        }

        .use-btn {
            width: 30px;
            height: 30px;
            border-radius: 7px;
            background: rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.25);
            color: #10b981;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
        }

        .use-btn:hover {
            background: rgba(16, 185, 129, 0.2);
            transform: scale(1.1);
        }

        .spec-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.72rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .ebc-badge {
            background: rgba(217, 119, 6, 0.15);
            color: #f59e0b;
            border: 1px solid rgba(217, 119, 6, 0.25);
        }

        .alpha-badge {
            background: rgba(16, 185, 129, 0.12);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.25);
        }

        .low-stock {
            opacity: 0.55;
        }

        .qty-empty {
            color: #ef4444 !important;
            border-color: rgba(239, 68, 68, 0.4) !important;
        }

        /* Use stock modal */
        .use-modal-info {
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
        }

        .use-modal-name {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .use-modal-stock {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .use-modal-stock span {
            color: var(--accent-amber);
            font-weight: 700;
        }

        .use-input-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .use-input-row input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border-subtle);
            color: var(--text-primary);
            padding: 14px 18px;
            border-radius: 12px;
            font-family: 'Work Sans', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            transition: border-color 0.3s;
        }

        .use-input-row input:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
        }

        .use-unit-label {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-muted);
            min-width: 40px;
        }

        .use-preview {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 20px;
            min-height: 20px;
            transition: color 0.2s;
        }

        .use-preview.ok { color: #10b981; }
        .use-preview.warn { color: #f59e0b; }
        .use-preview.error { color: #ef4444; }

        .btn-use-confirm {
            background: linear-gradient(135deg, #10b981, #059669);
            color: #fff;
            font-weight: 700;
            padding: 10px 24px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .btn-use-confirm:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        /* Edit Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(6px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.open {
            display: flex;
        }

        .modal-card {
            background: #1a1a1a;
            border: 1px solid rgba(255,149,0,0.3);
            border-radius: 20px;
            padding: 32px;
            width: 100%;
            max-width: 540px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.7);
            animation: fadeInUp 0.25s ease-out;
        }

        .modal-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-amber), var(--accent-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .modal-full {
            grid-column: 1 / -1;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn-save {
            background: linear-gradient(135deg, var(--accent-amber) 0%, var(--accent-gold) 100%);
            color: #000;
            font-weight: 700;
            padding: 10px 24px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.9rem;
        }

        .btn-save:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(255,149,0,0.4);
        }

        .btn-cancel {
            background: rgba(255,255,255,0.05);
            color: var(--text-muted);
            font-weight: 500;
            padding: 10px 24px;
            border-radius: 10px;
            border: 1px solid var(--border-subtle);
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.9rem;
        }

        .btn-cancel:hover {
            background: rgba(255,255,255,0.1);
            color: var(--text-primary);
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .section-title::before {
            content: '';
            width: 4px;
            height: 28px;
            background: linear-gradient(180deg, var(--accent-amber) 0%, var(--accent-gold) 100%);
            border-radius: 2px;
        }
        
        .status-message {
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 500;
            margin-top: 12px;
            animation: slideIn 0.3s ease-out;
        }
        
        .status-success {
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #10b981;
        }
        
        .status-error {
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }
        
        .status-info {
            background: rgba(59, 130, 246, 0.15);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #3b82f6;
        }
        
        .icon-wrapper {
            font-size: 1.2rem;
            filter: grayscale(0.2) brightness(1.2);
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }
        
        .empty-state::before {
            content: 'üç∫';
            font-size: 4rem;
            display: block;
            margin-bottom: 16px;
            opacity: 0.3;
        }
        
        /* Modern Form Styles */
        .form-group {
            position: relative;
        }
        
        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .label-icon {
            font-size: 1.1rem;
        }
        
        .label-hint {
            margin-left: auto;
            font-size: 0.75rem;
            color: var(--accent-amber);
            text-transform: none;
            font-weight: 500;
            letter-spacing: normal;
        }
        
        .form-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border-subtle);
            color: var(--text-primary);
            padding: 14px 18px;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-family: 'Work Sans', sans-serif;
            font-size: 1rem;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--accent-amber);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 0 4px rgba(255, 149, 0, 0.1);
            transform: translateY(-1px);
        }
        
        .form-input::placeholder {
            color: rgba(160, 160, 160, 0.5);
        }
        
        .select-wrapper {
            position: relative;
        }
        
        .select-wrapper::after {
            content: '‚ñº';
            position: absolute;
            right: 18px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            color: var(--accent-amber);
            font-size: 0.75rem;
        }
        
        .form-select {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border-subtle);
            color: var(--text-primary);
            padding: 14px 18px;
            padding-right: 45px;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-family: 'Work Sans', sans-serif;
            font-size: 1rem;
            appearance: none;
            cursor: pointer;
        }
        
        .form-select:focus {
            outline: none;
            border-color: var(--accent-amber);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 0 4px rgba(255, 149, 0, 0.1);
        }
        
        .form-select option {
            background: #1a1a1a;
            color: var(--text-primary);
            padding: 10px;
        }
        
        .form-select optgroup {
            background: #111111;
            color: var(--accent-amber);
            font-style: normal;
            font-weight: 700;
            font-size: 0.85rem;
            letter-spacing: 0.03em;
            padding: 8px 4px 4px;
        }
        
        .form-select optgroup option {
            background: #1a1a1a;
            color: var(--text-primary);
            font-style: normal;
            font-weight: 400;
            padding-left: 16px;
        }
        
        .btn-add-item {
            width: 100%;
            background: linear-gradient(135deg, var(--accent-amber) 0%, var(--accent-gold) 100%);
            color: #000;
            font-weight: 700;
            padding: 16px 32px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-size: 0.95rem;
            letter-spacing: 0.05em;
            box-shadow: 0 4px 15px rgba(255, 149, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-add-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .btn-add-item:hover::before {
            left: 100%;
        }
        
        .btn-add-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 149, 0, 0.5);
        }
        
        .btn-add-item:active {
            transform: translateY(0);
        }
        
        .btn-icon {
            font-size: 1.2rem;
        }
        
        .btn-arrow {
            margin-left: auto;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }
        
        .btn-add-item:hover .btn-arrow {
            transform: translateX(4px);
        }

        /* ‚îÄ‚îÄ Combobox searchable dropdown ‚îÄ‚îÄ */
        .combobox {
            position: relative;
        }
        .combobox-input-wrap {
            position: relative;
            display: flex;
            align-items: center;
        }
        .combobox-search-icon {
            position: absolute;
            left: 14px;
            font-size: 0.95rem;
            pointer-events: none;
            z-index: 1;
            opacity: 0.6;
        }
        .combobox-input {
            width: 100%;
            background: rgba(255,255,255,0.05);
            border: 2px solid var(--border-subtle);
            color: var(--text-primary);
            padding: 14px 40px 14px 42px;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-family: 'Work Sans', sans-serif;
            font-size: 1rem;
        }
        .combobox-input:focus {
            outline: none;
            border-color: var(--accent-amber);
            background: rgba(255,255,255,0.08);
            box-shadow: 0 0 0 4px rgba(255,149,0,0.1);
        }
        .combobox-input::placeholder { color: rgba(160,160,160,0.5); }
        .combobox-input.has-value {
            border-color: rgba(255,149,0,0.5);
            background: rgba(255,149,0,0.05);
        }
        .combobox-clear {
            position: absolute;
            right: 12px;
            background: rgba(255,255,255,0.08);
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .combobox-clear:hover { background: rgba(239,68,68,0.2); color: #ef4444; }
        .combobox-dropdown {
            position: absolute;
            top: calc(100% + 6px);
            left: 0;
            right: 0;
            background: #1c1c1c;
            border: 1px solid rgba(255,149,0,0.3);
            border-radius: 12px;
            z-index: 100;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            animation: fadeInUp 0.15s ease-out;
        }
        .combobox-list {
            overflow-y: auto;
            max-height: 300px;
        }
        .combobox-list::-webkit-scrollbar { width: 4px; }
        .combobox-list::-webkit-scrollbar-track { background: transparent; }
        .combobox-list::-webkit-scrollbar-thumb { background: rgba(255,149,0,0.3); border-radius: 2px; }
        .combobox-group-label {
            padding: 8px 14px 4px;
            font-size: 0.68rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--accent-amber);
            background: rgba(255,149,0,0.05);
            border-top: 1px solid rgba(255,149,0,0.08);
            position: sticky;
            top: 0;
        }
        .combobox-group-label:first-child { border-top: none; }
        .combobox-option {
            padding: 9px 14px;
            cursor: pointer;
            font-size: 0.88rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            transition: background 0.12s;
        }
        .combobox-option:hover, .combobox-option.focused { background: rgba(255,149,0,0.1); }
        .combobox-option.selected { background: rgba(255,149,0,0.15); color: var(--accent-gold); }
        .combobox-option-name { flex: 1; font-weight: 500; }
        .combobox-option-name mark {
            background: rgba(255,149,0,0.3);
            color: var(--accent-gold);
            border-radius: 2px;
            padding: 0 1px;
        }
        .combobox-option-meta { display: flex; align-items: center; gap: 6px; flex-shrink: 0; }
        .combobox-option-origin { font-size: 0.73rem; color: var(--text-muted); }
        .combobox-option-spec {
            font-size: 0.68rem;
            font-weight: 600;
            padding: 1px 6px;
            border-radius: 8px;
        }
        .combobox-option-spec.ebc { background: rgba(217,119,6,0.15); color: #f59e0b; }
        .combobox-option-spec.alpha { background: rgba(16,185,129,0.12); color: #10b981; }
        .combobox-option.custom-option {
            border-top: 1px solid var(--border-subtle);
            color: var(--accent-amber);
            font-style: italic;
            margin-top: 2px;
        }
        .combobox-empty { padding: 20px; text-align: center; color: var(--text-muted); font-size: 0.875rem; }
        .combobox-count {
            padding: 5px 14px;
            font-size: 0.7rem;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.15);
        }
    </style>
</head>
<body>
    <div class="container mx-auto px-4 py-8 max-w-7xl relative z-10">
        <!-- Header -->
        <div class="glass-card p-8 mb-8 animate-fade-up">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <div>
                    <h1 class="text-5xl mb-2 bg-gradient-to-r from-amber-500 to-yellow-400 bg-clip-text text-transparent">
                        Brewing Inventory
                    </h1>
                    <p class="text-gray-400 text-lg">G√©rez vos ingr√©dients avec style</p>
                </div>
                <div class="icon-wrapper text-6xl">üç∫</div>
            </div>
        </div>

        <!-- GitHub Configuration - Collapsible -->
        <div class="collapsible-section animate-fade-up stagger-1">
            <div class="collapsible-header" onclick="toggleCollapsible('config')">
                <div class="collapsible-title">
                    <span>‚öôÔ∏è</span>
                    <span>Configuration GitHub</span>
                </div>
                <div class="collapsible-icon">‚ñº</div>
            </div>
            <div class="collapsible-content" id="collapsible-config">
                <div class="collapsible-inner">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">Token GitHub</label>
                            <input type="password" id="githubToken" placeholder="ghp_..." class="w-full">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">Repository</label>
                            <input type="text" id="githubRepo" placeholder="username/brewing-inventory" class="w-full">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">Fichier de donn√©es</label>
                            <input type="text" id="githubFile" value="inventory.json" class="w-full">
                        </div>
                        <div class="flex items-end gap-3">
                            <button onclick="loadFromGitHub()" class="btn-secondary flex-1">
                                üì• Charger
                            </button>
                            <button onclick="saveToGitHub()" class="btn-primary flex-1">
                                üíæ Sauvegarder
                            </button>
                        </div>
                    </div>
                    <div id="githubStatus"></div>
                </div>
            </div>
        </div>

        <!-- Import/Export - Collapsible -->
        <div class="collapsible-section animate-fade-up stagger-2">
            <div class="collapsible-header" onclick="toggleCollapsible('import')">
                <div class="collapsible-title">
                    <span>üì¶</span>
                    <span>Import / Export</span>
                </div>
                <div class="collapsible-icon">‚ñº</div>
            </div>
            <div class="collapsible-content" id="collapsible-import">
                <div class="collapsible-inner">
                    <div class="flex gap-3 flex-wrap">
                        <button onclick="exportToJSON()" class="btn-secondary">
                            üì§ Export JSON
                        </button>
                        <button onclick="exportToCSV()" class="btn-secondary">
                            üìä Export CSV
                        </button>
                        <label class="btn-secondary cursor-pointer">
                            üì• Import JSON
                            <input type="file" accept=".json" onchange="importFromJSON(event)" class="hidden">
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Item Form -->
        <div class="glass-card p-8 mb-8 animate-fade-up stagger-3">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold bg-gradient-to-r from-amber-500 to-yellow-400 bg-clip-text text-transparent">
                    Nouvel Ingr√©dient
                </h2>
                <div class="text-3xl">‚ûï</div>
            </div>
            
            <div class="space-y-6">
                <!-- Row 1: Category and Name -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label class="form-label">
                            <span class="label-icon">üìÅ</span>
                            <span>Cat√©gorie</span>
                        </label>
                        <div class="select-wrapper">
                            <select id="itemCategory" class="form-select">
                                <option value="malt">üåæ Malt</option>
                                <option value="houblon">üåø Houblon</option>
                                <option value="levure">üß¨ Levure</option>
                                <option value="autre">‚ú® Autre</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <span class="label-icon">üè∑Ô∏è</span>
                            <span>Nom</span>
                            <span class="label-hint" id="ingredientCount">0 ingr√©dients</span>
                        </label>
                        <div class="combobox" id="ingredientCombobox">
                            <div class="combobox-input-wrap">
                                <span class="combobox-search-icon">üîç</span>
                                <input
                                    type="text"
                                    id="ingredientSearch"
                                    class="combobox-input"
                                    placeholder="Rechercher un ingr√©dient..."
                                    autocomplete="off"
                                    oninput="filterIngredients(this.value)"
                                    onfocus="openCombobox()"
                                    onkeydown="comboboxKeydown(event)"
                                >
                                <button type="button" class="combobox-clear" id="comboboxClear" onclick="clearIngredientSearch()" style="display:none;" title="Effacer">‚úï</button>
                            </div>
                            <div class="combobox-dropdown" id="ingredientDropdown" style="display:none;">
                                <div class="combobox-list" id="ingredientList"></div>
                            </div>
                        </div>
                        <input type="hidden" id="itemName">
                        <div id="customNameWrapper" style="display:none; margin-top: 10px;">
                            <input type="text" id="itemNameCustom" placeholder="Saisir le nom de l'ingr√©dient..." class="form-input">
                        </div>
                    </div>
                </div>
                
                <!-- Row 2: Quantity and Unit -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label class="form-label">
                            <span class="label-icon">‚öñÔ∏è</span>
                            <span>Quantit√©</span>
                        </label>
                        <input type="number" id="itemQuantity" placeholder="1000" step="0.01" class="form-input">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <span class="label-icon">üìè</span>
                            <span>Unit√©</span>
                        </label>
                        <div class="select-wrapper">
                            <select id="itemUnit" class="form-select">
                                <option value="g">grammes (g)</option>
                                <option value="kg">kilogrammes (kg)</option>
                                <option value="L">litres (L)</option>
                                <option value="mL">millilitres (mL)</option>
                                <option value="unit√©">unit√©</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Row 3: Origin and Notes -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label class="form-label">
                            <span class="label-icon">üåç</span>
                            <span>Origine / Vari√©t√©</span>
                        </label>
                        <input type="text" id="itemOrigin" placeholder="Ex: USA, Allemagne, Fermentis..." class="form-input">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <span class="label-icon">üìù</span>
                            <span>Notes</span>
                        </label>
                        <input type="text" id="itemNotes" placeholder="Notes optionnelles" class="form-input">
                    </div>
                </div>
                
                <!-- Row 4: Spec field (EBC for malt, Alpha acid for houblon) -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="specFieldRow" style="display:none;">
                    <div class="form-group" id="ebcGroup" style="display:none;">
                        <label class="form-label">
                            <span class="label-icon">üé®</span>
                            <span>EBC</span>
                            <span class="label-hint">Couleur du malt</span>
                        </label>
                        <input type="number" id="itemEbc" placeholder="Ex: 4, 120, 400..." step="0.1" min="0" class="form-input">
                    </div>
                    <div class="form-group" id="alphaGroup" style="display:none;">
                        <label class="form-label">
                            <span class="label-icon">‚öóÔ∏è</span>
                            <span>Acides alpha (%)</span>
                            <span class="label-hint">Amertume</span>
                        </label>
                        <input type="number" id="itemAlpha" placeholder="Ex: 5.5, 12.5..." step="0.1" min="0" max="30" class="form-input">
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="pt-4">
                    <button onclick="addItem()" class="btn-add-item">
                        <span class="btn-icon">‚ûï</span>
                        <span>Ajouter l'ingr√©dient</span>
                        <span class="btn-arrow">‚Üí</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="glass-card p-4 mb-8 animate-fade-up stagger-4">
            <div class="tab-container">
                <button onclick="switchTab('all')" class="tab-button active" id="tab-all">
                    <span>Tous</span>
                    <span class="tab-badge" id="badge-all">0</span>
                </button>
                <button onclick="switchTab('malt')" class="tab-button" id="tab-malt">
                    <span>üåæ Malts</span>
                    <span class="tab-badge" id="badge-malt">0</span>
                </button>
                <button onclick="switchTab('houblon')" class="tab-button" id="tab-houblon">
                    <span>üåø Houblons</span>
                    <span class="tab-badge" id="badge-houblon">0</span>
                </button>
                <button onclick="switchTab('levure')" class="tab-button" id="tab-levure">
                    <span>üß¨ Levures</span>
                    <span class="tab-badge" id="badge-levure">0</span>
                </button>
                <button onclick="switchTab('autre')" class="tab-button" id="tab-autre">
                    <span>‚ú® Autres</span>
                    <span class="tab-badge" id="badge-autre">0</span>
                </button>
            </div>
        </div>

        <!-- Inventory List -->
        <div class="glass-card p-6 animate-fade-up stagger-4">
            <h2 class="section-title">Inventaire</h2>
            
            <!-- Tab Content: All -->
            <div id="content-all" class="tab-content active">
                <div id="inventoryList-all" class="space-y-3"></div>
                <div id="emptyMessage-all" class="empty-state">
                    Aucun ingr√©dient dans l'inventaire
                </div>
            </div>
            
            <!-- Tab Content: Malt -->
            <div id="content-malt" class="tab-content">
                <div id="inventoryList-malt" class="space-y-3"></div>
                <div id="emptyMessage-malt" class="empty-state">
                    Aucun malt dans l'inventaire
                </div>
            </div>
            
            <!-- Tab Content: Houblon -->
            <div id="content-houblon" class="tab-content">
                <div id="inventoryList-houblon" class="space-y-3"></div>
                <div id="emptyMessage-houblon" class="empty-state">
                    Aucun houblon dans l'inventaire
                </div>
            </div>
            
            <!-- Tab Content: Levure -->
            <div id="content-levure" class="tab-content">
                <div id="inventoryList-levure" class="space-y-3"></div>
                <div id="emptyMessage-levure" class="empty-state">
                    Aucune levure dans l'inventaire
                </div>
            </div>
            
            <!-- Tab Content: Autre -->
            <div id="content-autre" class="tab-content">
                <div id="inventoryList-autre" class="space-y-3"></div>
                <div id="emptyMessage-autre" class="empty-state">
                    Aucun autre ingr√©dient dans l'inventaire
                </div>
            </div>
        </div>
    </div>

    <script>
        let inventory = [];
        let currentTab = 'all';
        let githubSha = null;

        // Predefined ingredient lists
        const ingredientDatabase = {
            malt: [
                // Base Malts
                { name: 'Pilsner Malt', origin: 'Allemagne', ebc: 3 },
                { name: 'Pale Ale Malt', origin: 'UK', ebc: 6 },
                { name: 'Pale Malt 2-Row', origin: 'USA', ebc: 5 },
                { name: 'Pale Malt 6-Row', origin: 'USA', ebc: 5 },
                { name: 'Maris Otter', origin: 'UK', ebc: 6 },
                { name: 'Golden Promise', origin: 'UK', ebc: 6 },
                { name: 'Vienna Malt', origin: 'Autriche', ebc: 9 },
                { name: 'Munich Malt Type I', origin: 'Allemagne', ebc: 14 },
                { name: 'Munich Malt Type II', origin: 'Allemagne', ebc: 20 },
                { name: 'Wheat Malt', origin: 'Allemagne', ebc: 4 },
                { name: 'Wheat Malt', origin: 'Belgique', ebc: 4 },
                { name: 'Rye Malt (Seigle)', origin: 'Allemagne', ebc: 7 },
                { name: 'Oat Malt (Avoine)', origin: 'UK', ebc: 5 },
                { name: 'Mild Ale Malt', origin: 'UK', ebc: 8 },
                { name: 'Marris Otter Heritage', origin: 'UK', ebc: 6 },
                
                // Crystal/Caramel Malts
                { name: 'Caramel/Crystal 10L', origin: 'USA', ebc: 20 },
                { name: 'Caramel/Crystal 20L', origin: 'USA', ebc: 39 },
                { name: 'Caramel/Crystal 30L', origin: 'USA', ebc: 59 },
                { name: 'Caramel/Crystal 40L', origin: 'USA', ebc: 79 },
                { name: 'Caramel/Crystal 60L', origin: 'USA', ebc: 118 },
                { name: 'Caramel/Crystal 80L', origin: 'USA', ebc: 158 },
                { name: 'Caramel/Crystal 120L', origin: 'USA', ebc: 236 },
                { name: 'Caramel Pils', origin: 'Allemagne', ebc: 5 },
                { name: 'Caramunich I', origin: 'Allemagne', ebc: 90 },
                { name: 'Caramunich II', origin: 'Allemagne', ebc: 120 },
                { name: 'Caramunich III', origin: 'Allemagne', ebc: 160 },
                { name: 'Caravienne', origin: 'Belgique', ebc: 50 },
                { name: 'Cara Red', origin: 'Allemagne', ebc: 50 },
                { name: 'Cara Hell', origin: 'Allemagne', ebc: 25 },
                { name: 'Cara Aroma', origin: 'Allemagne', ebc: 300 },
                { name: 'Cara Bohemian', origin: 'Allemagne', ebc: 80 },
                { name: 'Carafoam', origin: 'Allemagne', ebc: 4 },
                { name: 'Crystal Medium', origin: 'UK', ebc: 150 },
                { name: 'Crystal Dark', origin: 'UK', ebc: 300 },
                
                // Roasted/Dark Malts
                { name: 'Chocolate Malt', origin: 'UK', ebc: 900 },
                { name: 'Chocolate Malt', origin: 'USA', ebc: 800 },
                { name: 'Chocolate Rye', origin: 'Allemagne', ebc: 600 },
                { name: 'Chocolate Wheat', origin: 'Allemagne', ebc: 700 },
                { name: 'Black Malt', origin: 'UK', ebc: 1300 },
                { name: 'Black Patent Malt', origin: 'USA', ebc: 1400 },
                { name: 'Roasted Barley', origin: 'UK', ebc: 1200 },
                { name: 'Carafa I', origin: 'Allemagne', ebc: 900 },
                { name: 'Carafa II', origin: 'Allemagne', ebc: 1150 },
                { name: 'Carafa III', origin: 'Allemagne', ebc: 1400 },
                { name: 'Carafa Special I', origin: 'Allemagne', ebc: 900 },
                { name: 'Carafa Special II', origin: 'Allemagne', ebc: 1150 },
                { name: 'Carafa Special III', origin: 'Allemagne', ebc: 1400 },
                { name: 'Midnight Wheat', origin: 'USA', ebc: 1000 },
                { name: 'Blackprinz', origin: 'Allemagne', ebc: 1200 },
                
                // Specialty Malts
                { name: 'Amber Malt', origin: 'UK', ebc: 70 },
                { name: 'Brown Malt', origin: 'UK', ebc: 150 },
                { name: 'Biscuit Malt', origin: 'Belgique', ebc: 45 },
                { name: 'Victory Malt', origin: 'USA', ebc: 50 },
                { name: 'Aromatic Malt', origin: 'Belgique', ebc: 70 },
                { name: 'Melanoidin Malt', origin: 'Allemagne', ebc: 70 },
                { name: 'Special B', origin: 'Belgique', ebc: 300 },
                { name: 'Abbey Malt', origin: 'Belgique', ebc: 30 },
                { name: 'Munich Malt', origin: 'Belgique', ebc: 25 },
                { name: 'Honey Malt', origin: 'Canada', ebc: 50 },
                { name: 'Gambrinus Honey', origin: 'Canada', ebc: 50 },
                { name: 'Briess Victory', origin: 'USA', ebc: 50 },
                { name: 'Briess Special Roast', origin: 'USA', ebc: 100 },
                
                // Acidulated/Technical Malts
                { name: 'Acidulated Malt (Sauermalz)', origin: 'Allemagne', ebc: 4 },
                { name: 'Acid Malt', origin: 'Weyermann', ebc: 4 },
                
                // Smoked Malts
                { name: 'Beechwood Smoked Malt', origin: 'Allemagne', ebc: 5 },
                { name: 'Rauchmalz', origin: 'Allemagne', ebc: 5 },
                { name: 'Cherry Smoked Malt', origin: 'USA', ebc: 5 },
                { name: 'Peated Malt', origin: 'UK', ebc: 5 },
                { name: 'Mesquite Smoked Malt', origin: 'USA', ebc: 5 },
                
                // Torrified/Flaked Grains
                { name: 'Torrified Wheat', origin: 'UK', ebc: 3 },
                { name: 'Torrified Barley', origin: 'UK', ebc: 3 },
                { name: 'Flaked Oats', origin: 'USA', ebc: 2 },
                { name: 'Flaked Barley', origin: 'UK', ebc: 2 },
                { name: 'Flaked Wheat', origin: 'USA', ebc: 2 },
                { name: 'Flaked Rye', origin: 'USA', ebc: 4 },
                { name: 'Flaked Corn (Maize)', origin: 'USA', ebc: 1 },
                { name: 'Flaked Rice', origin: 'USA', ebc: 1 },
                
                // Other Specialty
                { name: 'Dextrin Malt (Cara-Pils)', origin: 'USA', ebc: 3 },
                { name: 'Light Munich', origin: 'Allemagne', ebc: 14 },
                { name: 'Dark Munich', origin: 'Allemagne', ebc: 25 },
                { name: 'Pale Chocolate', origin: 'UK', ebc: 600 },
                { name: 'Extra Pale Malt', origin: 'Belgique', ebc: 3 },
                { name: 'Ch√¢teau Pilsen', origin: 'Belgique', ebc: 3 },
                { name: 'Ch√¢teau Munich', origin: 'Belgique', ebc: 25 },
                { name: 'Ch√¢teau Vienna', origin: 'Belgique', ebc: 9 },
                { name: 'Ch√¢teau Wheat', origin: 'Belgique', ebc: 4 },
                { name: 'Ch√¢teau Caf√©', origin: 'Belgique', ebc: 900 }
            ],
            houblon: [
                // American Hops
                { name: 'Cascade', origin: 'USA', alpha: 5.5 },
                { name: 'Centennial', origin: 'USA', alpha: 10.0 },
                { name: 'Chinook', origin: 'USA', alpha: 12.0 },
                { name: 'Columbus (CTZ)', origin: 'USA', alpha: 15.0 },
                { name: 'Tomahawk (CTZ)', origin: 'USA', alpha: 15.0 },
                { name: 'Zeus (CTZ)', origin: 'USA', alpha: 15.0 },
                { name: 'Citra', origin: 'USA', alpha: 12.0 },
                { name: 'Mosaic', origin: 'USA', alpha: 12.5 },
                { name: 'Simcoe', origin: 'USA', alpha: 13.0 },
                { name: 'Amarillo', origin: 'USA', alpha: 9.0 },
                { name: 'Warrior', origin: 'USA', alpha: 16.0 },
                { name: 'Magnum', origin: 'USA', alpha: 14.0 },
                { name: 'Nugget', origin: 'USA', alpha: 13.0 },
                { name: 'Willamette', origin: 'USA', alpha: 5.0 },
                { name: 'Mt. Hood', origin: 'USA', alpha: 5.0 },
                { name: 'Liberty', origin: 'USA', alpha: 4.5 },
                { name: 'Crystal', origin: 'USA', alpha: 3.5 },
                { name: 'Sterling', origin: 'USA', alpha: 7.0 },
                { name: 'Vanguard', origin: 'USA', alpha: 5.5 },
                { name: 'Azacca', origin: 'USA', alpha: 15.0 },
                { name: 'El Dorado', origin: 'USA', alpha: 15.0 },
                { name: 'Ekuanot (Equinox)', origin: 'USA', alpha: 15.0 },
                { name: 'Lemondrop', origin: 'USA', alpha: 6.0 },
                { name: 'Pekko', origin: 'USA', alpha: 13.0 },
                { name: 'Sabro', origin: 'USA', alpha: 15.0 },
                { name: 'Idaho 7', origin: 'USA', alpha: 13.0 },
                { name: 'Strata', origin: 'USA', alpha: 13.0 },
                { name: 'Sultana', origin: 'USA', alpha: 14.0 },
                { name: 'Talus', origin: 'USA', alpha: 8.5 },
                { name: 'Triumph', origin: 'USA', alpha: 9.0 },
                { name: 'Glacier', origin: 'USA', alpha: 5.5 },
                { name: 'Santiam', origin: 'USA', alpha: 6.0 },
                { name: 'Summit', origin: 'USA', alpha: 17.0 },
                { name: 'Apollo', origin: 'USA', alpha: 19.0 },
                { name: 'Bravo', origin: 'USA', alpha: 15.0 },
                { name: 'HBC 472', origin: 'USA', alpha: 13.0 },
                { name: 'Cashmere', origin: 'USA', alpha: 8.0 },
                { name: 'Comet', origin: 'USA', alpha: 9.5 },
                
                // German Hops
                { name: 'Hallertau Mittelfr√ºh', origin: 'Allemagne', alpha: 4.0 },
                { name: 'Hallertau Tradition', origin: 'Allemagne', alpha: 6.0 },
                { name: 'Hallertau Hersbrucker', origin: 'Allemagne', alpha: 3.5 },
                { name: 'Hallertau Blanc', origin: 'Allemagne', alpha: 10.0 },
                { name: 'Tettnanger', origin: 'Allemagne', alpha: 4.5 },
                { name: 'Spalt', origin: 'Allemagne', alpha: 4.5 },
                { name: 'Perle', origin: 'Allemagne', alpha: 8.0 },
                { name: 'Northern Brewer', origin: 'Allemagne', alpha: 9.0 },
                { name: 'Magnum', origin: 'Allemagne', alpha: 14.0 },
                { name: 'Merkur', origin: 'Allemagne', alpha: 13.5 },
                { name: 'Opal', origin: 'Allemagne', alpha: 8.0 },
                { name: 'Polaris', origin: 'Allemagne', alpha: 20.0 },
                { name: 'Herkules', origin: 'Allemagne', alpha: 16.0 },
                { name: 'Taurus', origin: 'Allemagne', alpha: 14.5 },
                { name: 'Callista', origin: 'Allemagne', alpha: 3.5 },
                { name: 'Mandarina Bavaria', origin: 'Allemagne', alpha: 8.5 },
                { name: 'Huell Melon', origin: 'Allemagne', alpha: 7.0 },
                { name: 'Saphir', origin: 'Allemagne', alpha: 4.0 },
                { name: 'Select', origin: 'Allemagne', alpha: 4.5 },
                { name: 'Smaragd', origin: 'Allemagne', alpha: 5.5 },
                
                // UK Hops
                { name: 'East Kent Golding', origin: 'UK', alpha: 5.0 },
                { name: 'Fuggle', origin: 'UK', alpha: 4.5 },
                { name: 'Challenger', origin: 'UK', alpha: 8.0 },
                { name: 'Target', origin: 'UK', alpha: 11.0 },
                { name: 'First Gold', origin: 'UK', alpha: 7.5 },
                { name: 'Admiral', origin: 'UK', alpha: 14.0 },
                { name: 'Bramling Cross', origin: 'UK', alpha: 6.5 },
                { name: 'Phoenix', origin: 'UK', alpha: 10.0 },
                { name: 'Progress', origin: 'UK', alpha: 6.0 },
                { name: 'Northdown', origin: 'UK', alpha: 8.5 },
                { name: 'Pilgrim', origin: 'UK', alpha: 10.5 },
                { name: 'Pioneer', origin: 'UK', alpha: 9.0 },
                { name: 'Sovereign', origin: 'UK', alpha: 5.5 },
                { name: 'Whitbread Golding Variety', origin: 'UK', alpha: 6.0 },
                { name: 'Jester', origin: 'UK', alpha: 8.5 },
                { name: 'Olicana', origin: 'UK', alpha: 7.5 },
                { name: 'Endeavour', origin: 'UK', alpha: 8.5 },
                { name: 'Godiva', origin: 'UK', alpha: 6.5 },
                
                // Czech Hops
                { name: 'Saaz', origin: 'R√©publique Tch√®que', alpha: 3.5 },
                { name: 'Premiant', origin: 'R√©publique Tch√®que', alpha: 9.0 },
                { name: 'Sladek', origin: 'R√©publique Tch√®que', alpha: 7.5 },
                { name: 'Kazbek', origin: 'R√©publique Tch√®que', alpha: 6.5 },
                
                // New Zealand Hops
                { name: 'Nelson Sauvin', origin: 'Nouvelle-Z√©lande', alpha: 12.5 },
                { name: 'Motueka', origin: 'Nouvelle-Z√©lande', alpha: 7.0 },
                { name: 'Riwaka', origin: 'Nouvelle-Z√©lande', alpha: 5.5 },
                { name: 'Wakatu', origin: 'Nouvelle-Z√©lande', alpha: 7.0 },
                { name: 'Wai-iti', origin: 'Nouvelle-Z√©lande', alpha: 3.0 },
                { name: 'Kohatu', origin: 'Nouvelle-Z√©lande', alpha: 7.0 },
                { name: 'Rakau', origin: 'Nouvelle-Z√©lande', alpha: 11.0 },
                { name: 'Pacifica', origin: 'Nouvelle-Z√©lande', alpha: 5.5 },
                { name: 'Pacific Jade', origin: 'Nouvelle-Z√©lande', alpha: 13.0 },
                { name: 'Pacific Gem', origin: 'Nouvelle-Z√©lande', alpha: 15.0 },
                { name: 'Taiheke', origin: 'Nouvelle-Z√©lande', alpha: 9.0 },
                { name: 'Nectaron', origin: 'Nouvelle-Z√©lande', alpha: 10.0 },
                
                // Australian Hops
                { name: 'Galaxy', origin: 'Australie', alpha: 14.0 },
                { name: 'Ella', origin: 'Australie', alpha: 15.0 },
                { name: 'Vic Secret', origin: 'Australie', alpha: 16.0 },
                { name: 'Enigma', origin: 'Australie', alpha: 15.0 },
                { name: 'Topaz', origin: 'Australie', alpha: 17.0 },
                { name: 'Summer', origin: 'Australie', alpha: 6.0 },
                { name: 'Pride of Ringwood', origin: 'Australie', alpha: 9.5 },
                { name: 'Helga', origin: 'Australie', alpha: 5.5 },
                
                // Slovenian Hops
                { name: 'Styrian Golding', origin: 'Slov√©nie', alpha: 5.5 },
                { name: 'Bobek', origin: 'Slov√©nie', alpha: 7.0 },
                { name: 'Celeia', origin: 'Slov√©nie', alpha: 4.5 },
                { name: 'Aurora', origin: 'Slov√©nie', alpha: 8.5 },
                
                // French Hops
                { name: 'Strisselspalt', origin: 'France', alpha: 3.5 },
                { name: 'Aramis', origin: 'France', alpha: 8.0 },
                { name: 'Mistral', origin: 'France', alpha: 6.0 },
                { name: 'Triskel', origin: 'France', alpha: 9.0 },
                { name: 'Barbe Rouge', origin: 'France', alpha: 8.5 },
                { name: 'Elixir', origin: 'France', alpha: 13.5 },
                
                // Polish Hops
                { name: 'Lubelski', origin: 'Pologne', alpha: 4.0 },
                { name: 'Marynka', origin: 'Pologne', alpha: 10.0 },
                
                // Japanese Hops
                { name: 'Sorachi Ace', origin: 'Japon', alpha: 13.0 },
                
                // Belgian Hops
                { name: 'Brewers Gold', origin: 'Belgique', alpha: 8.5 },
                { name: 'Hallertau', origin: 'Belgique', alpha: 4.0 }
            ],
            levure: [
                // Fermentis Dry Yeasts
                { name: 'Safale US-05', origin: 'Fermentis - American Ale' },
                { name: 'Safale S-04', origin: 'Fermentis - English Ale' },
                { name: 'Safale S-33', origin: 'Fermentis - General Purpose Ale' },
                { name: 'Safale K-97', origin: 'Fermentis - German Ale' },
                { name: 'Safbrew WB-06', origin: 'Fermentis - Wheat Beer' },
                { name: 'Safbrew T-58', origin: 'Fermentis - Belgian Specialty' },
                { name: 'Safbrew S-33', origin: 'Fermentis - Belgian Ale' },
                { name: 'Safbrew BE-134', origin: 'Fermentis - Belgian Saison' },
                { name: 'Safbrew BE-256', origin: 'Fermentis - Belgian Abbey' },
                { name: 'Safbrew LA-01', origin: 'Fermentis - Lager' },
                { name: 'Saflager W-34/70', origin: 'Fermentis - West European Lager' },
                { name: 'Saflager S-23', origin: 'Fermentis - West European Lager' },
                { name: 'Saflager S-189', origin: 'Fermentis - Swiss Lager' },
                { name: 'Saflager W-68', origin: 'Fermentis - Bavarian Wheat' },
                
                // Lallemand Dry Yeasts
                { name: 'Lallemand Nottingham', origin: 'Lallemand - English Ale' },
                { name: 'Lallemand Windsor', origin: 'Lallemand - English Ale' },
                { name: 'Lallemand Belle Saison', origin: 'Lallemand - Belgian Saison' },
                { name: 'Lallemand Abbaye', origin: 'Lallemand - Belgian Abbey' },
                { name: 'Lallemand Munich Classic', origin: 'Lallemand - Bavarian Lager' },
                { name: 'Lallemand Diamond Lager', origin: 'Lallemand - Lager' },
                { name: 'Lallemand BRY-97', origin: 'Lallemand - American West Coast' },
                { name: 'Lallemand New England', origin: 'Lallemand - NEIPA' },
                { name: 'Lallemand Verdant IPA', origin: 'Lallemand - IPA' },
                { name: 'Lallemand Voss Kveik', origin: 'Lallemand - Kveik' },
                { name: 'Lallemand Koln', origin: 'Lallemand - K√∂lsch' },
                { name: 'Lallemand Munich Wheat', origin: 'Lallemand - Weizen' },
                { name: 'Lallemand Farmhouse', origin: 'Lallemand - Saison' },
                { name: 'Lallemand LalBrew Wit', origin: 'Lallemand - Witbier' },
                { name: 'Lallemand Danstar CBC-1', origin: 'Lallemand - Bottle Conditioning' },
                
                // Mangrove Jack's Dry Yeasts
                { name: 'Mangrove Jack M42 - New World Strong Ale', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M44 - US West Coast Ale', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M36 - Liberty Bell Ale', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M15 - Empire Ale', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M76 - Bavarian Lager', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M84 - Bohemian Lager', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M20 - Bavarian Wheat', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M47 - Belgian Abbey', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M31 - Belgian Tripel', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M29 - French Saison', origin: 'Mangrove Jack' },
                { name: 'Mangrove Jack M41 - Belgian Wit', origin: 'Mangrove Jack' },
                
                // Wyeast Liquid Yeasts
                { name: 'Wyeast 1056 - American Ale', origin: 'Wyeast' },
                { name: 'Wyeast 1272 - American Ale II', origin: 'Wyeast' },
                { name: 'Wyeast 1098 - British Ale', origin: 'Wyeast' },
                { name: 'Wyeast 1968 - London ESB', origin: 'Wyeast' },
                { name: 'Wyeast 1318 - London Ale III', origin: 'Wyeast' },
                { name: 'Wyeast 1332 - Northwest Ale', origin: 'Wyeast' },
                { name: 'Wyeast 1450 - Denny\'s Favorite 50', origin: 'Wyeast' },
                { name: 'Wyeast 2565 - K√∂lsch', origin: 'Wyeast' },
                { name: 'Wyeast 2633 - Oktoberfest Lager', origin: 'Wyeast' },
                { name: 'Wyeast 2124 - Bohemian Lager', origin: 'Wyeast' },
                { name: 'Wyeast 2206 - Bavarian Lager', origin: 'Wyeast' },
                { name: 'Wyeast 2308 - Munich Lager', origin: 'Wyeast' },
                { name: 'Wyeast 3068 - Weihenstephan Weizen', origin: 'Wyeast' },
                { name: 'Wyeast 3638 - Bavarian Wheat', origin: 'Wyeast' },
                { name: 'Wyeast 3333 - German Wheat', origin: 'Wyeast' },
                { name: 'Wyeast 3944 - Belgian Witbier', origin: 'Wyeast' },
                { name: 'Wyeast 1214 - Belgian Abbey', origin: 'Wyeast' },
                { name: 'Wyeast 3787 - Trappist High Gravity', origin: 'Wyeast' },
                { name: 'Wyeast 1762 - Belgian Abbey II', origin: 'Wyeast' },
                { name: 'Wyeast 3522 - Belgian Ardennes', origin: 'Wyeast' },
                { name: 'Wyeast 3724 - Belgian Saison', origin: 'Wyeast' },
                { name: 'Wyeast 3726 - Farmhouse Ale', origin: 'Wyeast' },
                { name: 'Wyeast 3711 - French Saison', origin: 'Wyeast' },
                
                // White Labs Liquid Yeasts
                { name: 'White Labs WLP001 - California Ale', origin: 'White Labs' },
                { name: 'White Labs WLP002 - English Ale', origin: 'White Labs' },
                { name: 'White Labs WLP004 - Irish Ale', origin: 'White Labs' },
                { name: 'White Labs WLP007 - Dry English Ale', origin: 'White Labs' },
                { name: 'White Labs WLP013 - London Ale', origin: 'White Labs' },
                { name: 'White Labs WLP051 - California Ale V', origin: 'White Labs' },
                { name: 'White Labs WLP060 - American Ale Blend', origin: 'White Labs' },
                { name: 'White Labs WLP090 - San Diego Super Yeast', origin: 'White Labs' },
                { name: 'White Labs WLP300 - Hefeweizen Ale', origin: 'White Labs' },
                { name: 'White Labs WLP320 - American Hefeweizen', origin: 'White Labs' },
                { name: 'White Labs WLP380 - Hefeweizen IV', origin: 'White Labs' },
                { name: 'White Labs WLP400 - Belgian Wit', origin: 'White Labs' },
                { name: 'White Labs WLP500 - Trappist Ale', origin: 'White Labs' },
                { name: 'White Labs WLP530 - Abbey Ale', origin: 'White Labs' },
                { name: 'White Labs WLP540 - Abbey IV', origin: 'White Labs' },
                { name: 'White Labs WLP550 - Belgian Ale', origin: 'White Labs' },
                { name: 'White Labs WLP565 - Belgian Saison I', origin: 'White Labs' },
                { name: 'White Labs WLP566 - Belgian Saison II', origin: 'White Labs' },
                { name: 'White Labs WLP568 - Belgian Saison Ale Blend', origin: 'White Labs' },
                { name: 'White Labs WLP800 - Pilsner Lager', origin: 'White Labs' },
                { name: 'White Labs WLP802 - Czech Budejovice Lager', origin: 'White Labs' },
                { name: 'White Labs WLP810 - San Francisco Lager', origin: 'White Labs' },
                { name: 'White Labs WLP820 - Oktoberfest/M√§rzen', origin: 'White Labs' },
                { name: 'White Labs WLP830 - German Lager', origin: 'White Labs' },
                { name: 'White Labs WLP833 - German Bock Lager', origin: 'White Labs' },
                { name: 'White Labs WLP838 - Southern German Lager', origin: 'White Labs' },
                { name: 'White Labs WLP029 - German Ale/K√∂lsch', origin: 'White Labs' },
                
                // Imperial Organic Yeasts
                { name: 'Imperial A07 - Flagship', origin: 'Imperial - American Ale' },
                { name: 'Imperial A24 - Dry Hop', origin: 'Imperial - IPA' },
                { name: 'Imperial A38 - Juice', origin: 'Imperial - NEIPA' },
                { name: 'Imperial B56 - Rustic', origin: 'Imperial - Farmhouse' },
                { name: 'Imperial L13 - Global', origin: 'Imperial - Lager' },
                { name: 'Imperial G03 - Dieter', origin: 'Imperial - German Lager' },
                
                // Other Specialty Yeasts
                { name: 'Omega Hothead (OYL-057)', origin: 'Omega - Kveik' },
                { name: 'Omega Lutra (OYL-071)', origin: 'Omega - Kveik' },
                { name: 'Omega DIPA (OYL-052)', origin: 'Omega - IPA' },
                { name: 'BrewFerm Blanche', origin: 'BrewFerm - Witbier' },
                { name: 'Danstar Munich', origin: 'Danstar - Wheat Beer' }
            ],
            autre: [
                // Sugars
                { name: 'Sucre de candi blanc', origin: 'Belgique' },
                { name: 'Sucre de candi brun fonc√©', origin: 'Belgique' },
                { name: 'Sucre de candi brun clair', origin: 'Belgique' },
                { name: 'Sucre de candi ambre', origin: 'Belgique' },
                { name: 'Sirop de candi blanc', origin: 'Belgique' },
                { name: 'Sirop de candi brun', origin: 'Belgique' },
                { name: 'Sirop de candi D-45', origin: 'Belgique' },
                { name: 'Sirop de candi D-90', origin: 'Belgique' },
                { name: 'Sirop de candi D-180', origin: 'Belgique' },
                { name: 'Miel toutes fleurs', origin: '' },
                { name: 'Miel d\'acacia', origin: '' },
                { name: 'Miel de ch√¢taignier', origin: '' },
                { name: 'Miel de lavande', origin: '' },
                { name: 'Sirop d\'√©rable', origin: 'Canada' },
                { name: 'Cassonade', origin: '' },
                { name: 'Sucre roux', origin: '' },
                { name: 'Sucre blanc', origin: '' },
                { name: 'Dextrose (glucose)', origin: '' },
                { name: 'Lactose', origin: '' },
                { name: 'M√©lasse', origin: '' },
                { name: 'Sirop d\'agave', origin: '' },
                { name: 'Turbinado', origin: '' },
                { name: 'Demerara', origin: '' },
                { name: 'Muscovado', origin: '' },
                
                // Flaked/Torrified Grains
                { name: 'Flocons d\'avoine', origin: '' },
                { name: 'Flocons de bl√©', origin: '' },
                { name: 'Flocons d\'orge', origin: '' },
                { name: 'Flocons de riz', origin: '' },
                { name: 'Flocons de ma√Øs', origin: '' },
                { name: 'Flocons de seigle', origin: '' },
                { name: 'Gritz de ma√Øs', origin: '' },
                { name: 'Riz brassicole', origin: '' },
                
                // Finings & Clarifiers
                { name: 'Irish Moss', origin: '' },
                { name: 'Whirlfloc', origin: '' },
                { name: 'Clarity Ferm', origin: '' },
                { name: 'Isinglass', origin: '' },
                { name: 'Bentonite', origin: '' },
                { name: 'Polyclar', origin: '' },
                { name: 'Super Moss', origin: '' },
                { name: 'Protafloc', origin: '' },
                
                // Water Treatment
                { name: 'Gypse (Sulfate de calcium)', origin: '' },
                { name: 'Chlorure de calcium', origin: '' },
                { name: 'Sel d\'Epsom (Sulfate de magn√©sium)', origin: '' },
                { name: 'Bicarbonate de sodium', origin: '' },
                { name: 'Craie (Carbonate de calcium)', origin: '' },
                { name: 'Chlorure de sodium (sel)', origin: '' },
                { name: 'Acide lactique', origin: '' },
                { name: 'Acide phosphorique', origin: '' },
                { name: 'Acide citrique', origin: '' },
                { name: 'Campden tablets (m√©tabisulfite)', origin: '' },
                
                // Nutrients & Additives
                { name: 'Nutriment de levure', origin: '' },
                { name: 'Diammonium phosphate (DAP)', origin: '' },
                { name: 'Servomyces', origin: '' },
                { name: 'Zinc', origin: '' },
                { name: 'Calcium', origin: '' },
                
                // Spices & Botanicals
                { name: 'Coriandre (graines)', origin: '' },
                { name: '√âcorces d\'orange am√®re (Cura√ßao)', origin: '' },
                { name: '√âcorces d\'orange douce', origin: '' },
                { name: '√âcorces de citron', origin: '' },
                { name: '√âcorces de pamplemousse', origin: '' },
                { name: 'Gingembre frais', origin: '' },
                { name: 'Gingembre s√©ch√©', origin: '' },
                { name: 'Cardamome', origin: '' },
                { name: 'Cannelle (b√¢tons)', origin: '' },
                { name: 'Cannelle (poudre)', origin: '' },
                { name: 'Clous de girofle', origin: '' },
                { name: 'Noix de muscade', origin: '' },
                { name: 'Anis √©toil√©', origin: '' },
                { name: 'Graines de paradis', origin: '' },
                { name: 'Poivre noir', origin: '' },
                { name: 'Poivre de Sichuan', origin: '' },
                { name: 'Piments s√©ch√©s', origin: '' },
                { name: 'Vanille (gousses)', origin: 'Madagascar' },
                { name: 'Vanille (extrait)', origin: '' },
                { name: 'R√©glisse', origin: '' },
                { name: 'Geni√®vre (baies)', origin: '' },
                { name: 'Anis vert', origin: '' },
                { name: 'Fenouil', origin: '' },
                { name: 'Carvi', origin: '' },
                { name: 'Fenugrec', origin: '' },
                
                // Coffee & Chocolate
                { name: 'Caf√© en grains', origin: '' },
                { name: 'Caf√© moulu', origin: '' },
                { name: 'Cold brew coffee', origin: '' },
                { name: 'Expresso', origin: '' },
                { name: 'Cacao nibs', origin: '' },
                { name: 'Cacao en poudre', origin: '' },
                { name: 'Chocolat noir', origin: '' },
                { name: 'Cacao brut', origin: '' },
                
                // Fruits
                { name: 'Cerise (Kriek)', origin: '' },
                { name: 'Framboise', origin: '' },
                { name: 'Fraise', origin: '' },
                { name: 'Myrtille', origin: '' },
                { name: 'M√ªre', origin: '' },
                { name: 'Cassis', origin: '' },
                { name: 'P√™che', origin: '' },
                { name: 'Abricot', origin: '' },
                { name: 'Mangue', origin: '' },
                { name: 'Fruit de la passion', origin: '' },
                { name: 'Ananas', origin: '' },
                { name: 'Noix de coco', origin: '' },
                { name: 'Banane', origin: '' },
                { name: 'Citron', origin: '' },
                { name: 'Lime', origin: '' },
                { name: 'Orange', origin: '' },
                { name: 'Pamplemousse', origin: '' },
                { name: 'Pur√©e de fruits', origin: '' },
                
                // Wood & Oak
                { name: 'Copeaux de ch√™ne am√©ricain (toast√© l√©ger)', origin: 'USA' },
                { name: 'Copeaux de ch√™ne am√©ricain (toast√© moyen)', origin: 'USA' },
                { name: 'Copeaux de ch√™ne am√©ricain (toast√© fort)', origin: 'USA' },
                { name: 'Copeaux de ch√™ne fran√ßais (toast√© l√©ger)', origin: 'France' },
                { name: 'Copeaux de ch√™ne fran√ßais (toast√© moyen)', origin: 'France' },
                { name: 'Copeaux de ch√™ne fran√ßais (toast√© fort)', origin: 'France' },
                { name: 'Spirales de ch√™ne', origin: '' },
                { name: 'Cubes de ch√™ne', origin: '' },
                { name: 'Douelles de ch√™ne', origin: '' },
                { name: 'Ch√™ne hongrois', origin: 'Hongrie' },
                { name: 'Cerisier (bois)', origin: '' },
                { name: 'Bois de c√®dre', origin: '' },
                
                // Other
                { name: 'Extrait de malt liquide (LME)', origin: '' },
                { name: 'Extrait de malt sec (DME)', origin: '' },
                { name: 'Extrait de bl√©', origin: '' },
                { name: 'G√©latine', origin: '' },
                { name: 'Agar-agar', origin: '' },
                { name: 'Pectinase', origin: '' },
                { name: 'Amylase', origin: '' },
                { name: 'Glucoamylase', origin: '' },
                { name: 'Ascorbic acid (vitamine C)', origin: '' },
                { name: 'M√©tabisulfite de potassium', origin: '' }
            ]
        };

        // Load from localStorage on start
        window.onload = function() {
            const saved = localStorage.getItem('brewingInventory');
            if (saved) {
                inventory = JSON.parse(saved);
                renderAllTabs();
            }
            
            // Load GitHub config
            const token = localStorage.getItem('githubToken');
            const repo = localStorage.getItem('githubRepo');
            const file = localStorage.getItem('githubFile');
            if (token) document.getElementById('githubToken').value = token;
            if (repo) document.getElementById('githubRepo').value = repo;
            if (file) document.getElementById('githubFile').value = file;
            
            // Setup autocomplete
            setupAutocomplete();
        };

        // ‚îÄ‚îÄ Combobox state ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        let _cbIngredients = [];   // flat list for current category
        let _cbGrouped = {};       // grouped for current category
        let _cbSelected = null;    // currently selected ingredient object
        let _cbFocusedIdx = -1;    // keyboard nav index
        let _cbAllOptions = [];    // all rendered options (flat, for keyboard nav)

        function setupAutocomplete() {
            const categorySelect = document.getElementById('itemCategory');
            categorySelect.addEventListener('change', populateIngredientSelect);
            populateIngredientSelect();
            // Close on outside click
            document.addEventListener('click', function(e) {
                if (!document.getElementById('ingredientCombobox').contains(e.target)) {
                    closeCombobox();
                }
            });
        }

        function populateIngredientSelect() {
            const category = document.getElementById('itemCategory').value;
            const countEl = document.getElementById('ingredientCount');

            // Reset state
            _cbSelected = null;
            _cbFocusedIdx = -1;
            document.getElementById('ingredientSearch').value = '';
            document.getElementById('ingredientSearch').classList.remove('has-value');
            document.getElementById('comboboxClear').style.display = 'none';
            document.getElementById('customNameWrapper').style.display = 'none';
            document.getElementById('itemName').value = '';
            document.getElementById('itemOrigin').value = '';
            document.getElementById('itemEbc').value = '';
            document.getElementById('itemAlpha').value = '';

            // Show/hide spec fields
            const specRow = document.getElementById('specFieldRow');
            const ebcGroup = document.getElementById('ebcGroup');
            const alphaGroup = document.getElementById('alphaGroup');
            if (category === 'malt') {
                specRow.style.display = '';
                ebcGroup.style.display = '';
                alphaGroup.style.display = 'none';
            } else if (category === 'houblon') {
                specRow.style.display = '';
                ebcGroup.style.display = 'none';
                alphaGroup.style.display = '';
            } else {
                specRow.style.display = 'none';
            }

            _cbIngredients = ingredientDatabase[category] || [];
            _cbGrouped = groupIngredients(category, _cbIngredients);
            countEl.textContent = `${_cbIngredients.length} ingr√©dients`;
            closeCombobox();
        }

        function openCombobox() {
            filterIngredients(document.getElementById('ingredientSearch').value);
        }

        function closeCombobox() {
            document.getElementById('ingredientDropdown').style.display = 'none';
            _cbFocusedIdx = -1;
        }

        function clearIngredientSearch() {
            _cbSelected = null;
            document.getElementById('ingredientSearch').value = '';
            document.getElementById('ingredientSearch').classList.remove('has-value');
            document.getElementById('comboboxClear').style.display = 'none';
            document.getElementById('itemName').value = '';
            document.getElementById('customNameWrapper').style.display = 'none';
            document.getElementById('itemOrigin').value = '';
            document.getElementById('itemEbc').value = '';
            document.getElementById('itemAlpha').value = '';
            document.getElementById('ingredientSearch').focus();
            filterIngredients('');
        }

        function filterIngredients(query) {
            const q = query.trim().toLowerCase();
            const dropdown = document.getElementById('ingredientDropdown');
            const list = document.getElementById('ingredientList');
            dropdown.style.display = 'block';
            _cbFocusedIdx = -1;
            _cbAllOptions = [];

            // Show/hide clear button
            document.getElementById('comboboxClear').style.display = query ? 'flex' : 'none';

            let html = '';
            let totalShown = 0;

            if (q === '') {
                // Show all grouped
                for (const [groupName, items] of Object.entries(_cbGrouped)) {
                    html += `<div class="combobox-group-label">${groupName}</div>`;
                    items.forEach(ing => {
                        const isSelected = _cbSelected && _cbSelected.name === ing.name;
                        html += renderOption(ing, q, isSelected);
                        _cbAllOptions.push(ing);
                        totalShown++;
                    });
                }
            } else {
                // Filter across all groups
                const matched = _cbIngredients.filter(ing =>
                    ing.name.toLowerCase().includes(q) ||
                    (ing.origin && ing.origin.toLowerCase().includes(q))
                );
                if (matched.length === 0) {
                    html = `<div class="combobox-empty">Aucun r√©sultat pour "<strong>${escapeHtml(query)}</strong>"</div>`;
                } else {
                    html += `<div class="combobox-count">${matched.length} r√©sultat${matched.length > 1 ? 's' : ''}</div>`;
                    matched.forEach(ing => {
                        const isSelected = _cbSelected && _cbSelected.name === ing.name;
                        html += renderOption(ing, q, isSelected);
                        _cbAllOptions.push(ing);
                        totalShown++;
                    });
                }
            }

            // Always add "custom" option at bottom
            html += `<div class="combobox-option custom-option" onclick="selectCustomOption()" data-custom="true">‚úèÔ∏è Saisie libre...</div>`;

            list.innerHTML = html;
        }

        function renderOption(ing, q, isSelected) {
            const idx = _cbAllOptions.length;
            let nameHtml = escapeHtml(ing.name);
            if (q) {
                const re = new RegExp('(' + escapeRegex(q) + ')', 'gi');
                nameHtml = escapeHtml(ing.name).replace(re, '<mark>$1</mark>');
            }
            let specHtml = '';
            if (ing.ebc != null) specHtml = `<span class="combobox-option-spec ebc">${ing.ebc} EBC</span>`;
            if (ing.alpha != null) specHtml = `<span class="combobox-option-spec alpha">${ing.alpha}% Œ±</span>`;

            return `<div class="combobox-option${isSelected ? ' selected' : ''}" 
                        onclick="selectIngredient(${idx})" 
                        data-idx="${idx}">
                        <span class="combobox-option-name">${nameHtml}</span>
                        <span class="combobox-option-meta">
                            ${ing.origin ? `<span class="combobox-option-origin">${escapeHtml(ing.origin)}</span>` : ''}
                            ${specHtml}
                        </span>
                    </div>`;
        }

        function selectIngredient(idx) {
            const ing = _cbAllOptions[idx];
            if (!ing) return;
            _cbSelected = ing;

            const searchEl = document.getElementById('ingredientSearch');
            searchEl.value = ing.name;
            searchEl.classList.add('has-value');
            document.getElementById('comboboxClear').style.display = 'flex';
            document.getElementById('itemName').value = ing.name;
            document.getElementById('customNameWrapper').style.display = 'none';

            // Auto-fill
            document.getElementById('itemOrigin').value = ing.origin || '';
            document.getElementById('itemEbc').value = ing.ebc != null ? ing.ebc : '';
            document.getElementById('itemAlpha').value = ing.alpha != null ? ing.alpha : '';

            closeCombobox();
        }

        function selectCustomOption() {
            _cbSelected = { name: '__custom__' };
            document.getElementById('ingredientSearch').value = '‚úèÔ∏è Saisie libre';
            document.getElementById('ingredientSearch').classList.add('has-value');
            document.getElementById('comboboxClear').style.display = 'flex';
            document.getElementById('itemName').value = '__custom__';
            document.getElementById('customNameWrapper').style.display = 'block';
            document.getElementById('itemOrigin').value = '';
            document.getElementById('itemEbc').value = '';
            document.getElementById('itemAlpha').value = '';
            document.getElementById('itemNameCustom').focus();
            closeCombobox();
        }

        function comboboxKeydown(e) {
            const dropdown = document.getElementById('ingredientDropdown');
            if (dropdown.style.display === 'none') {
                if (e.key === 'ArrowDown' || e.key === 'Enter') openCombobox();
                return;
            }
            const options = document.querySelectorAll('#ingredientList .combobox-option:not(.custom-option)');
            if (e.key === 'ArrowDown') {
                e.preventDefault();
                _cbFocusedIdx = Math.min(_cbFocusedIdx + 1, options.length - 1);
                updateFocus(options);
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                _cbFocusedIdx = Math.max(_cbFocusedIdx - 1, -1);
                updateFocus(options);
            } else if (e.key === 'Enter') {
                e.preventDefault();
                if (_cbFocusedIdx >= 0 && options[_cbFocusedIdx]) {
                    options[_cbFocusedIdx].click();
                } else if (_cbAllOptions.length === 1) {
                    selectIngredient(0);
                }
            } else if (e.key === 'Escape') {
                closeCombobox();
            }
        }

        function updateFocus(options) {
            options.forEach((opt, i) => {
                opt.classList.toggle('focused', i === _cbFocusedIdx);
                if (i === _cbFocusedIdx) opt.scrollIntoView({ block: 'nearest' });
            });
        }

        function escapeHtml(str) {
            return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
        }

        function escapeRegex(str) {
            return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        function groupIngredients(category, ingredients) {
            const groups = {
                malt: {
                    'üåæ Malts de Base': ['Pilsner Malt', 'Pale Ale Malt', 'Pale Malt 2-Row', 'Pale Malt 6-Row', 'Maris Otter', 'Golden Promise', 'Vienna Malt', 'Munich Malt Type I', 'Munich Malt Type II', 'Wheat Malt', 'Rye Malt (Seigle)', 'Oat Malt (Avoine)', 'Mild Ale Malt', 'Marris Otter Heritage'],
                    'üç¨ Malts Crystal / Caramel': ['Caramel/Crystal 10L', 'Caramel/Crystal 20L', 'Caramel/Crystal 30L', 'Caramel/Crystal 40L', 'Caramel/Crystal 60L', 'Caramel/Crystal 80L', 'Caramel/Crystal 120L', 'Caramel Pils', 'Caramunich I', 'Caramunich II', 'Caramunich III', 'Caravienne', 'Cara Red', 'Cara Hell', 'Cara Aroma', 'Cara Bohemian', 'Carafoam', 'Crystal Medium', 'Crystal Dark'],
                    'üç´ Malts Torr√©fi√©s / Fonc√©s': ['Chocolate Malt', 'Chocolate Rye', 'Chocolate Wheat', 'Black Malt', 'Black Patent Malt', 'Roasted Barley', 'Carafa I', 'Carafa II', 'Carafa III', 'Carafa Special I', 'Carafa Special II', 'Carafa Special III', 'Midnight Wheat', 'Blackprinz'],
                    '‚ú® Malts Sp√©ciaux': ['Amber Malt', 'Brown Malt', 'Biscuit Malt', 'Victory Malt', 'Aromatic Malt', 'Melanoidin Malt', 'Special B', 'Abbey Malt', 'Honey Malt', 'Gambrinus Honey', 'Briess Victory', 'Briess Special Roast'],
                    'üî¨ Malts Techniques': ['Acidulated Malt (Sauermalz)', 'Acid Malt', 'Dextrin Malt (Cara-Pils)'],
                    'üî• Malts Fum√©s': ['Beechwood Smoked Malt', 'Rauchmalz', 'Cherry Smoked Malt', 'Peated Malt', 'Mesquite Smoked Malt'],
                    'üåÄ Flocons & Torrifi√©s': ['Torrified Wheat', 'Torrified Barley', 'Flaked Oats', 'Flaked Barley', 'Flaked Wheat', 'Flaked Rye', 'Flaked Corn (Maize)', 'Flaked Rice'],
                    'üè∞ Ch√¢teau (Belgique)': ['Ch√¢teau Pilsen', 'Ch√¢teau Munich', 'Ch√¢teau Vienna', 'Ch√¢teau Wheat', 'Ch√¢teau Caf√©'],
                    'üåô Autres Malts': null
                },
                houblon: {
                    'üá∫üá∏ Houblons Am√©ricains': ['Cascade', 'Centennial', 'Chinook', 'Columbus (CTZ)', 'Tomahawk (CTZ)', 'Zeus (CTZ)', 'Citra', 'Mosaic', 'Simcoe', 'Amarillo', 'Warrior', 'Magnum', 'Nugget', 'Willamette', 'Mt. Hood', 'Liberty', 'Crystal', 'Sterling', 'Vanguard', 'Azacca', 'El Dorado', 'Ekuanot (Equinox)', 'Lemondrop', 'Pekko', 'Sabro', 'Idaho 7', 'Strata', 'Sultana', 'Talus', 'Triumph', 'Glacier', 'Santiam', 'Summit', 'Apollo', 'Bravo', 'HBC 472', 'Cashmere', 'Comet'],
                    'üá©üá™ Houblons Allemands': ['Hallertau Mittelfr√ºh', 'Hallertau Tradition', 'Hallertau Hersbrucker', 'Hallertau Blanc', 'Tettnanger', 'Spalt', 'Perle', 'Northern Brewer', 'Merkur', 'Opal', 'Polaris', 'Herkules', 'Taurus', 'Callista', 'Mandarina Bavaria', 'Huell Melon', 'Saphir', 'Select', 'Smaragd'],
                    'üá¨üáß Houblons Anglais': ['East Kent Golding', 'Fuggle', 'Challenger', 'Target', 'First Gold', 'Admiral', 'Bramling Cross', 'Phoenix', 'Progress', 'Northdown', 'Pilgrim', 'Pioneer', 'Sovereign', 'Whitbread Golding Variety', 'Jester', 'Olicana', 'Endeavour', 'Godiva'],
                    'üá®üáø Houblons Tch√®ques': ['Saaz', 'Premiant', 'Sladek', 'Kazbek'],
                    'üá≥üáø Houblons N√©o-Z√©landais': ['Nelson Sauvin', 'Motueka', 'Riwaka', 'Wakatu', 'Wai-iti', 'Kohatu', 'Rakau', 'Pacifica', 'Pacific Jade', 'Pacific Gem', 'Taiheke', 'Nectaron'],
                    'üá¶üá∫ Houblons Australiens': ['Galaxy', 'Ella', 'Vic Secret', 'Enigma', 'Topaz', 'Summer', 'Pride of Ringwood', 'Helga'],
                    'üá∏üáÆ Houblons Slov√®nes': ['Styrian Golding', 'Bobek', 'Celeia', 'Aurora'],
                    'üá´üá∑ Houblons Fran√ßais': ['Strisselspalt', 'Aramis', 'Mistral', 'Triskel', 'Barbe Rouge', 'Elixir'],
                    'üåç Autres Origines': null
                },
                levure: {
                    'üî¥ Fermentis (S√®che)': ['Safale US-05', 'Safale S-04', 'Safale S-33', 'Safale K-97', 'Safbrew WB-06', 'Safbrew T-58', 'Safbrew S-33', 'Safbrew BE-134', 'Safbrew BE-256', 'Safbrew LA-01', 'Saflager W-34/70', 'Saflager S-23', 'Saflager S-189', 'Saflager W-68'],
                    'üü° Lallemand (S√®che)': ['Lallemand Nottingham', 'Lallemand Windsor', 'Lallemand Belle Saison', 'Lallemand Abbaye', 'Lallemand Munich Classic', 'Lallemand Diamond Lager', 'Lallemand BRY-97', 'Lallemand New England', 'Lallemand Verdant IPA', 'Lallemand Voss Kveik', 'Lallemand Koln', 'Lallemand Munich Wheat', 'Lallemand Farmhouse', 'Lallemand LalBrew Wit', 'Lallemand Danstar CBC-1'],
                    'üü† Mangrove Jack\'s (S√®che)': ['Mangrove Jack M42 - New World Strong Ale', 'Mangrove Jack M44 - US West Coast Ale', 'Mangrove Jack M36 - Liberty Bell Ale', 'Mangrove Jack M15 - Empire Ale', 'Mangrove Jack M76 - Bavarian Lager', 'Mangrove Jack M84 - Bohemian Lager', 'Mangrove Jack M20 - Bavarian Wheat', 'Mangrove Jack M47 - Belgian Abbey', 'Mangrove Jack M31 - Belgian Tripel', 'Mangrove Jack M29 - French Saison', 'Mangrove Jack M41 - Belgian Wit'],
                    'üîµ Wyeast (Liquide)': ingredients.filter(i => i.origin === 'Wyeast').map(i => i.name),
                    '‚ö™ White Labs (Liquide)': ingredients.filter(i => i.origin === 'White Labs').map(i => i.name),
                    'üü£ Imperial Organic (Liquide)': ingredients.filter(i => i.origin && i.origin.startsWith('Imperial')).map(i => i.name),
                    'üåø Kveik & Sp√©ciales': ['Lallemand Voss Kveik', 'Omega Hothead (OYL-057)', 'Omega Lutra (OYL-071)', 'Omega DIPA (OYL-052)', 'BrewFerm Blanche', 'Danstar Munich'],
                    'üî¨ Autres Levures': null
                },
                autre: {
                    'üç¨ Sucres & Sirops': ['Sucre de candi blanc', 'Sucre de candi brun fonc√©', 'Sucre de candi brun clair', 'Sucre de candi ambre', 'Sirop de candi blanc', 'Sirop de candi brun', 'Sirop de candi D-45', 'Sirop de candi D-90', 'Sirop de candi D-180', 'Miel toutes fleurs', 'Miel d\'acacia', 'Miel de ch√¢taignier', 'Miel de lavande', 'Sirop d\'√©rable', 'Cassonade', 'Sucre roux', 'Sucre blanc', 'Dextrose (glucose)', 'Lactose', 'M√©lasse', 'Sirop d\'agave', 'Turbinado', 'Demerara', 'Muscovado'],
                    'üåæ Flocons & Grains Non Malt√©s': ['Flocons d\'avoine', 'Flocons de bl√©', 'Flocons d\'orge', 'Flocons de riz', 'Flocons de ma√Øs', 'Flocons de seigle', 'Gritz de ma√Øs', 'Riz brassicole'],
                    'üî¨ Agents de Clarification': ['Irish Moss', 'Whirlfloc', 'Clarity Ferm', 'Isinglass', 'Bentonite', 'Polyclar', 'Super Moss', 'Protafloc'],
                    'üíß Traitement de l\'Eau': ['Gypse (Sulfate de calcium)', 'Chlorure de calcium', 'Sel d\'Epsom (Sulfate de magn√©sium)', 'Bicarbonate de sodium', 'Craie (Carbonate de calcium)', 'Chlorure de sodium (sel)', 'Acide lactique', 'Acide phosphorique', 'Acide citrique', 'Campden tablets (m√©tabisulfite)'],
                    'üß™ Nutriments & Additifs': ['Nutriment de levure', 'Diammonium phosphate (DAP)', 'Servomyces', 'Zinc', 'Calcium'],
                    'üåø √âpices & Botaniques': ['Coriandre (graines)', '√âcorces d\'orange am√®re (Cura√ßao)', '√âcorces d\'orange douce', '√âcorces de citron', '√âcorces de pamplemousse', 'Gingembre frais', 'Gingembre s√©ch√©', 'Cardamome', 'Cannelle (b√¢tons)', 'Cannelle (poudre)', 'Clous de girofle', 'Noix de muscade', 'Anis √©toil√©', 'Graines de paradis', 'Poivre noir', 'Poivre de Sichuan', 'Piments s√©ch√©s', 'Vanille (gousses)', 'Vanille (extrait)', 'R√©glisse', 'Geni√®vre (baies)', 'Anis vert', 'Fenouil', 'Carvi', 'Fenugrec'],
                    '‚òï Caf√© & Chocolat': ['Caf√© en grains', 'Caf√© moulu', 'Cold brew coffee', 'Expresso', 'Cacao nibs', 'Cacao en poudre', 'Chocolat noir', 'Cacao brut'],
                    'üçì Fruits': ['Cerise (Kriek)', 'Framboise', 'Fraise', 'Myrtille', 'M√ªre', 'Cassis', 'P√™che', 'Abricot', 'Mangue', 'Fruit de la passion', 'Ananas', 'Noix de coco', 'Banane', 'Citron', 'Lime', 'Orange', 'Pamplemousse', 'Pur√©e de fruits'],
                    'ü™µ Bois & Ch√™ne': ['Copeaux de ch√™ne am√©ricain (toast√© l√©ger)', 'Copeaux de ch√™ne am√©ricain (toast√© moyen)', 'Copeaux de ch√™ne am√©ricain (toast√© fort)', 'Copeaux de ch√™ne fran√ßais (toast√© l√©ger)', 'Copeaux de ch√™ne fran√ßais (toast√© moyen)', 'Copeaux de ch√™ne fran√ßais (toast√© fort)', 'Spirales de ch√™ne', 'Cubes de ch√™ne', 'Douelles de ch√™ne', 'Ch√™ne hongrois', 'Cerisier (bois)', 'Bois de c√®dre'],
                    'üß¥ Extraits & Enzymes': ['Extrait de malt liquide (LME)', 'Extrait de malt sec (DME)', 'Extrait de bl√©', 'G√©latine', 'Agar-agar', 'Pectinase', 'Amylase', 'Glucoamylase', 'Ascorbic acid (vitamine C)', 'M√©tabisulfite de potassium'],
                    'üîß Autres': null
                }
            };

            const categoryGroups = groups[category] || {};
            const result = {};
            const usedNames = new Set();

            for (const [groupName, nameList] of Object.entries(categoryGroups)) {
                if (nameList === null) {
                    // Catch-all group for remaining items
                    const remaining = ingredients.filter(ing => !usedNames.has(ing.name));
                    if (remaining.length > 0) {
                        result[groupName] = remaining;
                        remaining.forEach(i => usedNames.add(i.name));
                    }
                } else {
                    const groupItems = ingredients.filter(ing => nameList.includes(ing.name) && !usedNames.has(ing.name));
                    // Remove duplicates within the group
                    const seen = new Set();
                    const uniqueItems = groupItems.filter(i => {
                        if (seen.has(i.name)) return false;
                        seen.add(i.name);
                        return true;
                    });
                    if (uniqueItems.length > 0) {
                        result[groupName] = uniqueItems;
                        uniqueItems.forEach(i => usedNames.add(i.name));
                    }
                }
            }

            // If no grouping defined, return all items in one group
            if (Object.keys(result).length === 0) {
                result['Tous les ingr√©dients'] = ingredients;
            }

            return result;
        }

        function addItem() {
            const nameSelect = document.getElementById('itemName');
            const nameCustom = document.getElementById('itemNameCustom');
            const name = (nameSelect.value === '__custom__' || nameSelect.value === '')
                ? (nameSelect.value === '__custom__' ? nameCustom.value.trim() : '')
                : nameSelect.value.trim();
            const category = document.getElementById('itemCategory').value;
            const quantity = parseFloat(document.getElementById('itemQuantity').value);
            const unit = document.getElementById('itemUnit').value;
            const origin = document.getElementById('itemOrigin').value.trim();
            const notes = document.getElementById('itemNotes').value.trim();
            const ebcVal = document.getElementById('itemEbc').value;
            const alphaVal = document.getElementById('itemAlpha').value;

            if (!name || isNaN(quantity)) {
                alert('Veuillez remplir au moins le nom et la quantit√©');
                return;
            }

            const item = {
                id: Date.now(),
                name,
                category,
                quantity,
                unit,
                origin,
                notes,
                ebc: ebcVal !== '' ? parseFloat(ebcVal) : null,
                alpha: alphaVal !== '' ? parseFloat(alphaVal) : null,
                dateAdded: new Date().toISOString()
            };

            inventory.push(item);
            saveToLocal();
            renderAllTabs();
            
            // Switch to the category tab of the added item
            switchTab(category);

            // Clear form
            _cbSelected = null;
            document.getElementById('ingredientSearch').value = '';
            document.getElementById('ingredientSearch').classList.remove('has-value');
            document.getElementById('comboboxClear').style.display = 'none';
            document.getElementById('itemName').value = '';
            document.getElementById('itemNameCustom').value = '';
            document.getElementById('customNameWrapper').style.display = 'none';
            document.getElementById('itemQuantity').value = '';
            document.getElementById('itemOrigin').value = '';
            document.getElementById('itemNotes').value = '';
            document.getElementById('itemEbc').value = '';
            document.getElementById('itemAlpha').value = '';
        }

        function deleteItem(id) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cet ingr√©dient ?')) {
                inventory = inventory.filter(item => item.id !== id);
                saveToLocal();
                renderAllTabs();
            }
        }

        function updateQuantity(id, newQuantity) {
            const item = inventory.find(i => i.id === id);
            if (item) {
                item.quantity = parseFloat(newQuantity);
                saveToLocal();
                renderAllTabs();
            }
        }

        function switchTab(tab) {
            currentTab = tab;
            
            // Update tab buttons
            document.querySelectorAll('[id^="tab-"]').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`tab-${tab}`).classList.add('active');
            
            // Update tab content
            document.querySelectorAll('[id^="content-"]').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`content-${tab}`).classList.add('active');
        }

        function updateBadges() {
            const counts = {
                all: inventory.length,
                malt: inventory.filter(i => i.category === 'malt').length,
                houblon: inventory.filter(i => i.category === 'houblon').length,
                levure: inventory.filter(i => i.category === 'levure').length,
                autre: inventory.filter(i => i.category === 'autre').length
            };
            
            Object.keys(counts).forEach(key => {
                const badge = document.getElementById(`badge-${key}`);
                if (badge) {
                    badge.textContent = counts[key];
                }
            });
        }

        function renderAllTabs() {
            const categories = ['all', 'malt', 'houblon', 'levure', 'autre'];
            
            categories.forEach(category => {
                renderTab(category);
            });
            
            updateBadges();
        }

        function renderTab(category) {
            const container = document.getElementById(`inventoryList-${category}`);
            const emptyMessage = document.getElementById(`emptyMessage-${category}`);
            
            if (!container || !emptyMessage) return;
            
            const filtered = category === 'all' 
                ? inventory 
                : inventory.filter(item => item.category === category);

            if (filtered.length === 0) {
                container.innerHTML = '';
                emptyMessage.style.display = 'block';
                return;
            }

            emptyMessage.style.display = 'none';

            const showCategory = category === 'all';

            container.innerHTML = `
                <table class="inventory-table">
                    <thead>
                        <tr>
                            <th>Ingr√©dient</th>
                            ${showCategory ? '<th>Cat.</th>' : ''}
                            <th>Origine</th>
                            <th>Spec.</th>
                            <th>Notes</th>
                            <th class="th-right">Stock</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        ${filtered.map(item => {
                            const specBadge = item.ebc != null
                                ? `<span class="spec-badge ebc-badge">${item.ebc} EBC</span>`
                                : item.alpha != null
                                ? `<span class="spec-badge alpha-badge">${item.alpha}% Œ±</span>`
                                : '<span style="opacity:0.3">‚Äî</span>';
                            const lowStock = item.quantity <= 0;
                            return `
                            <tr class="inventory-item${lowStock ? ' low-stock' : ''}">
                                <td><div class="item-name" title="${item.name}">${item.name}</div></td>
                                ${showCategory ? `<td><span class="category-badge ${item.category}">${item.category}</span></td>` : ''}
                                <td><div class="item-origin" title="${item.origin || ''}">${item.origin || '<span style="opacity:0.3">‚Äî</span>'}</div></td>
                                <td>${specBadge}</td>
                                <td><div class="item-notes" title="${item.notes || ''}">${item.notes || '<span style="opacity:0.3">‚Äî</span>'}</div></td>
                                <td class="item-qty-cell">
                                    <input 
                                        type="number" 
                                        value="${item.quantity}" 
                                        onchange="updateQuantity(${item.id}, this.value)"
                                        class="quantity-input${lowStock ? ' qty-empty' : ''}"
                                        step="0.01"
                                    ><span class="item-unit">${item.unit}</span>
                                </td>
                                <td>
                                    <div class="item-actions">
                                        <button onclick="openUseModal(${item.id})" class="use-btn" title="Utiliser / D√©duire du stock">üß™</button>
                                        <button onclick="openEditModal(${item.id})" class="edit-btn" title="Modifier">‚úèÔ∏è</button>
                                        <button onclick="deleteItem(${item.id})" class="delete-btn" title="Supprimer">üóëÔ∏è</button>
                                    </div>
                                </td>
                            </tr>`;
                        }).join('')}
                    </tbody>
                </table>
            `;
        }

        function saveToLocal() {
            localStorage.setItem('brewingInventory', JSON.stringify(inventory));
        }

        function toggleCollapsible(id) {
            const content = document.getElementById(`collapsible-${id}`);
            const header = content.previousElementSibling;
            
            // Close all other collapsibles
            document.querySelectorAll('.collapsible-content').forEach(el => {
                if (el.id !== `collapsible-${id}`) {
                    el.classList.remove('active');
                    el.previousElementSibling.classList.remove('active');
                }
            });
            
            // Toggle current
            content.classList.toggle('active');
            header.classList.toggle('active');
        }

        // GitHub Functions
        async function saveToGitHub() {
            const token = document.getElementById('githubToken').value.trim();
            const repo = document.getElementById('githubRepo').value.trim();
            const file = document.getElementById('githubFile').value.trim();
            
            if (!token || !repo || !file) {
                showStatus('Veuillez remplir tous les champs GitHub', 'error');
                return;
            }

            // Save config
            localStorage.setItem('githubToken', token);
            localStorage.setItem('githubRepo', repo);
            localStorage.setItem('githubFile', file);

            try {
                showStatus('Sauvegarde en cours...', 'info');

                const content = btoa(unescape(encodeURIComponent(JSON.stringify(inventory, null, 2))));
                const url = `https://api.github.com/repos/${repo}/contents/${file}`;

                const body = {
                    message: `Update inventory - ${new Date().toISOString()}`,
                    content: content
                };

                if (githubSha) {
                    body.sha = githubSha;
                }

                const response = await fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(body)
                });

                if (response.ok) {
                    const data = await response.json();
                    githubSha = data.content.sha;
                    showStatus('‚úÖ Sauvegard√© avec succ√®s sur GitHub!', 'success');
                } else {
                    const error = await response.json();
                    showStatus(`‚ùå Erreur: ${error.message}`, 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Erreur: ${error.message}`, 'error');
            }
        }

        async function loadFromGitHub() {
            const token = document.getElementById('githubToken').value.trim();
            const repo = document.getElementById('githubRepo').value.trim();
            const file = document.getElementById('githubFile').value.trim();
            
            if (!token || !repo || !file) {
                showStatus('Veuillez remplir tous les champs GitHub', 'error');
                return;
            }

            try {
                showStatus('Chargement en cours...', 'info');

                const url = `https://api.github.com/repos/${repo}/contents/${file}`;
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `token ${token}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    githubSha = data.sha;
                    const content = decodeURIComponent(escape(atob(data.content)));
                    inventory = JSON.parse(content);
                    saveToLocal();
                    renderAllTabs();
                    showStatus('‚úÖ Charg√© avec succ√®s depuis GitHub!', 'success');
                } else if (response.status === 404) {
                    showStatus('‚ÑπÔ∏è Fichier non trouv√© sur GitHub. Vous pouvez sauvegarder pour le cr√©er.', 'info');
                } else {
                    const error = await response.json();
                    showStatus(`‚ùå Erreur: ${error.message}`, 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Erreur: ${error.message}`, 'error');
            }
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('githubStatus');
            const classes = {
                success: 'status-success',
                error: 'status-error',
                info: 'status-info'
            };
            statusDiv.className = `status-message ${classes[type]}`;
            statusDiv.textContent = message;
            
            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.textContent = '';
                    statusDiv.className = '';
                }, 3000);
            }
        }

        // Export/Import Functions
        function exportToJSON() {
            const dataStr = JSON.stringify(inventory, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `brewing-inventory-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function exportToCSV() {
            if (inventory.length === 0) {
                alert('Aucune donn√©e √† exporter');
                return;
            }

            const headers = ['Nom', 'Cat√©gorie', 'Quantit√©', 'Unit√©', 'Origine', 'Notes', 'Date Ajout'];
            const rows = inventory.map(item => [
                item.name,
                item.category,
                item.quantity,
                item.unit,
                item.origin || '',
                item.notes || '',
                new Date(item.dateAdded).toLocaleDateString('fr-FR')
            ]);

            const csv = [
                headers.join(','),
                ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
            ].join('\n');

            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `brewing-inventory-${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function importFromJSON(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    if (Array.isArray(imported)) {
                        if (confirm(`Importer ${imported.length} ingr√©dients ? Cela remplacera l'inventaire actuel.`)) {
                            inventory = imported;
                            saveToLocal();
                            renderAllTabs();
                            alert('‚úÖ Import r√©ussi!');
                        }
                    } else {
                        alert('‚ùå Format JSON invalide');
                    }
                } catch (error) {
                    alert('‚ùå Erreur lors de l\'import: ' + error.message);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }
    </script>
    <!-- Use Stock Modal -->
    <div class="modal-overlay" id="useModal" onclick="handleUseOverlayClick(event)">
        <div class="modal-card" style="max-width: 420px;">
            <div class="modal-title">üß™ Utiliser du stock</div>
            <input type="hidden" id="useItemId">
            <div class="use-modal-info">
                <div class="use-modal-name" id="useItemName">‚Äî</div>
                <div class="use-modal-stock">Stock actuel : <span id="useItemStock">‚Äî</span></div>
            </div>
            <label class="form-label" style="margin-bottom:10px;"><span class="label-icon">‚öñÔ∏è</span> Quantit√© utilis√©e</label>
            <div class="use-input-row">
                <input type="number" id="useAmount" placeholder="0" step="0.01" min="0" oninput="updateUsePreview()">
                <span class="use-unit-label" id="useUnitLabel">g</span>
            </div>
            <div class="use-preview" id="usePreview"></div>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeUseModal()">Annuler</button>
                <button class="btn-use-confirm" onclick="confirmUse()">‚úÖ D√©duire du stock</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="editModal" onclick="handleModalOverlayClick(event)">
        <div class="modal-card">
            <div class="modal-title">‚úèÔ∏è Modifier l'ingr√©dient</div>
            <input type="hidden" id="editItemId">
            <div class="modal-grid">
                <div class="form-group modal-full">
                    <label class="form-label"><span class="label-icon">üè∑Ô∏è</span> Nom</label>
                    <input type="text" id="editName" class="form-input" placeholder="Nom de l'ingr√©dient">
                </div>
                <div class="form-group">
                    <label class="form-label"><span class="label-icon">üìÅ</span> Cat√©gorie</label>
                    <div class="select-wrapper">
                        <select id="editCategory" class="form-select" onchange="updateEditSpecFields()">
                            <option value="malt">üåæ Malt</option>
                            <option value="houblon">üåø Houblon</option>
                            <option value="levure">üß¨ Levure</option>
                            <option value="autre">‚ú® Autre</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label"><span class="label-icon">üìè</span> Unit√©</label>
                    <div class="select-wrapper">
                        <select id="editUnit" class="form-select">
                            <option value="g">grammes (g)</option>
                            <option value="kg">kilogrammes (kg)</option>
                            <option value="L">litres (L)</option>
                            <option value="mL">millilitres (mL)</option>
                            <option value="unit√©">unit√©</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label"><span class="label-icon">‚öñÔ∏è</span> Quantit√©</label>
                    <input type="number" id="editQuantity" class="form-input" step="0.01" placeholder="0">
                </div>
                <div class="form-group">
                    <label class="form-label"><span class="label-icon">üåç</span> Origine / Vari√©t√©</label>
                    <input type="text" id="editOrigin" class="form-input" placeholder="Ex: USA, Fermentis...">
                </div>
                <div class="form-group" id="editEbcGroup" style="display:none;">
                    <label class="form-label"><span class="label-icon">üé®</span> EBC <span class="label-hint" style="color:var(--text-muted)">Couleur</span></label>
                    <input type="number" id="editEbc" class="form-input" step="0.1" min="0" placeholder="Ex: 4, 120...">
                </div>
                <div class="form-group" id="editAlphaGroup" style="display:none;">
                    <label class="form-label"><span class="label-icon">‚öóÔ∏è</span> Acides alpha (%) <span class="label-hint" style="color:var(--text-muted)">Amertume</span></label>
                    <input type="number" id="editAlpha" class="form-input" step="0.1" min="0" max="30" placeholder="Ex: 5.5...">
                </div>
                <div class="form-group modal-full">
                    <label class="form-label"><span class="label-icon">üìù</span> Notes</label>
                    <input type="text" id="editNotes" class="form-input" placeholder="Notes optionnelles">
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeEditModal()">Annuler</button>
                <button class="btn-save" onclick="saveEdit()">üíæ Sauvegarder</button>
            </div>
        </div>
    </div>

    <script>
        // ‚îÄ‚îÄ Use Stock Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function openUseModal(id) {
            const item = inventory.find(i => i.id === id);
            if (!item) return;
            document.getElementById('useItemId').value = id;
            document.getElementById('useItemName').textContent = item.name;
            document.getElementById('useItemStock').textContent = `${item.quantity} ${item.unit}`;
            document.getElementById('useUnitLabel').textContent = item.unit;
            document.getElementById('useAmount').value = '';
            document.getElementById('usePreview').textContent = '';
            document.getElementById('usePreview').className = 'use-preview';
            document.getElementById('useModal').classList.add('open');
            document.body.style.overflow = 'hidden';
            setTimeout(() => document.getElementById('useAmount').focus(), 100);
        }

        function closeUseModal() {
            document.getElementById('useModal').classList.remove('open');
            document.body.style.overflow = '';
        }

        function handleUseOverlayClick(e) {
            if (e.target === document.getElementById('useModal')) closeUseModal();
        }

        function updateUsePreview() {
            const id = parseInt(document.getElementById('useItemId').value);
            const item = inventory.find(i => i.id === id);
            if (!item) return;
            const amount = parseFloat(document.getElementById('useAmount').value);
            const preview = document.getElementById('usePreview');
            if (isNaN(amount) || amount <= 0) {
                preview.textContent = '';
                preview.className = 'use-preview';
                return;
            }
            const remaining = item.quantity - amount;
            if (remaining < 0) {
                preview.textContent = `‚ö†Ô∏è Insuffisant ! Stock : ${item.quantity} ${item.unit}, vous utilisez ${amount} ${item.unit}`;
                preview.className = 'use-preview error';
            } else if (remaining === 0) {
                preview.textContent = `‚ö†Ô∏è Stock √©puis√© apr√®s cette op√©ration`;
                preview.className = 'use-preview warn';
            } else {
                preview.textContent = `‚Üí Stock restant : ${Math.round(remaining * 1000) / 1000} ${item.unit}`;
                preview.className = 'use-preview ok';
            }
        }

        function confirmUse() {
            const id = parseInt(document.getElementById('useItemId').value);
            const item = inventory.find(i => i.id === id);
            if (!item) return;
            const amount = parseFloat(document.getElementById('useAmount').value);
            if (isNaN(amount) || amount <= 0) {
                alert('Veuillez saisir une quantit√© valide');
                return;
            }
            if (amount > item.quantity) {
                if (!confirm(`‚ö†Ô∏è Vous utilisez plus que le stock disponible (${item.quantity} ${item.unit}).\nLe stock passera en n√©gatif. Continuer ?`)) return;
            }
            item.quantity = Math.round((item.quantity - amount) * 10000) / 10000;
            saveToLocal();
            renderAllTabs();
            closeUseModal();
        }

        // ‚îÄ‚îÄ Edit Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function updateEditSpecFields() {
            const cat = document.getElementById('editCategory').value;
            document.getElementById('editEbcGroup').style.display = cat === 'malt' ? '' : 'none';
            document.getElementById('editAlphaGroup').style.display = cat === 'houblon' ? '' : 'none';
        }

        function openEditModal(id) {
            const item = inventory.find(i => i.id === id);
            if (!item) return;

            document.getElementById('editItemId').value = id;
            document.getElementById('editName').value = item.name;
            document.getElementById('editCategory').value = item.category;
            document.getElementById('editUnit').value = item.unit;
            document.getElementById('editQuantity').value = item.quantity;
            document.getElementById('editOrigin').value = item.origin || '';
            document.getElementById('editNotes').value = item.notes || '';
            document.getElementById('editEbc').value = item.ebc != null ? item.ebc : '';
            document.getElementById('editAlpha').value = item.alpha != null ? item.alpha : '';
            updateEditSpecFields();

            document.getElementById('editModal').classList.add('open');
            document.body.style.overflow = 'hidden';
            setTimeout(() => document.getElementById('editName').focus(), 100);
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('open');
            document.body.style.overflow = '';
        }

        function handleModalOverlayClick(e) {
            if (e.target === document.getElementById('editModal')) {
                closeEditModal();
            }
        }

        function saveEdit() {
            const id = parseInt(document.getElementById('editItemId').value);
            const item = inventory.find(i => i.id === id);
            if (!item) return;

            const name = document.getElementById('editName').value.trim();
            const quantity = parseFloat(document.getElementById('editQuantity').value);

            if (!name || isNaN(quantity)) {
                alert('Veuillez remplir au moins le nom et la quantit√©');
                return;
            }

            item.name = name;
            item.category = document.getElementById('editCategory').value;
            item.unit = document.getElementById('editUnit').value;
            item.quantity = quantity;
            item.origin = document.getElementById('editOrigin').value.trim();
            item.notes = document.getElementById('editNotes').value.trim();
            const ebcVal = document.getElementById('editEbc').value;
            const alphaVal = document.getElementById('editAlpha').value;
            item.ebc = ebcVal !== '' ? parseFloat(ebcVal) : null;
            item.alpha = alphaVal !== '' ? parseFloat(alphaVal) : null;

            saveToLocal();
            renderAllTabs();
            closeEditModal();
        }

        // Close modals on Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeEditModal();
                closeUseModal();
            }
        });
    </script>
</body>
</html>
